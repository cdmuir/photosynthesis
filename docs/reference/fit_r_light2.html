<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit models to estimate light respiration (\(R_\mathrm{d}\)) — fit_r_light2 • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit models to estimate light respiration (\(R_\mathrm{d}\)) — fit_r_light2"><meta property="og:description" content='We recommend using fit_photosynthesis() with argument .photo_fun = "r_light" rather than calling this function directly.'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/co2-response.html">Fitting CO2 response curves</a>
    </li>
    <li>
      <a href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a>
    </li>
    <li>
      <a href="../articles/light-respiration.html">Fit models to estimate light respiration</a>
    </li>
    <li>
      <a href="../articles/light-response.html">Fitting light response curves</a>
    </li>
    <li>
      <a href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a>
    </li>
    <li>
      <a href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
    <li>
      <a href="../articles/pressure-volume.html">Fitting pressure-volume curves</a>
    </li>
    <li>
      <a href="../articles/sensitivity-analysis.html">Sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a>
    </li>
    <li>
      <a href="../articles/temperature-response.html">Fitting temperature response curves</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit models to estimate light respiration (\(R_\mathrm{d}\))</h1>
    <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_r_light.R" class="external-link"><code>R/fit_r_light.R</code></a></small>
    <div class="hidden name"><code>fit_r_light2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>We recommend using <code><a href="fit_photosynthesis.html">fit_photosynthesis()</a></code> with argument <code>.photo_fun = "r_light"</code> rather than calling this function directly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_r_light2</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  .model <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  .method <span class="op">=</span> <span class="st">"ls"</span>,</span>
<span>  Q_lower <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Q_upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Q_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  C_upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  brm_options <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.data</dt>
<dd><p>A data frame containing plant ecophysiological data. See <code><a href="required_variables.html">required_variables()</a></code> for the variables required for each model.</p></dd>


<dt>.model</dt>
<dd><p>A character string of model name to use. See <code><a href="models.html">get_all_models()</a></code>.</p></dd>


<dt>.method</dt>
<dd><p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brms::brm()</a></code>. Default is 'ls'.</p></dd>


<dt>Q_lower</dt>
<dd><p>Lower light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models.</p></dd>


<dt>Q_upper</dt>
<dd><p>Upper light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models</p></dd>


<dt>Q_levels</dt>
<dd><p>A numeric vector of light intensity levels (\(\mu\)mol / mol) for estimating \(R_\mathrm{d}\) from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p></dd>


<dt>C_upper</dt>
<dd><p>Upper C (\(\mu\)mol / mol) limit for estimating \(R_\mathrm{d}\) from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p></dd>


<dt>quiet</dt>
<dd><p>Flag. Should messages be suppressed? Default is FALSE.</p></dd>


<dt>brm_options</dt>
<dd><p>A list of options passed to <code><a href="https://rdrr.io/pkg/brms/man/brm.html" class="external-link">brms::brm()</a></code> if <code>.method = "brms"</code>. Default is NULL.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<ul><li><p>If <code>.method = 'ls'</code>: an <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code> or <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> object.</p></li>
<li><p>If <code>.method = 'brms'</code>: a <code><a href="https://rdrr.io/pkg/brms/man/brmsfit-class.html" class="external-link">brms::brmsfit()</a></code> object.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>Confusingly, \(R_\mathrm{d}\) typically denotes respiration in the light, but you might see \(R_\mathrm{day}\) or \(R_\mathrm{light}\).</p>
<p><strong>Models</strong></p>
<p><em>Kok (1956)</em></p>
<p>The <code>kok_1956</code> model estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. Rd value should be negative,
denoting an efflux of CO2.</p>
<p><em>Yin et al. (2011)</em></p>
<p>The <code>yin_etal_2011</code> model estimates light respiration according
to the Yin <em>et al.</em> (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Rd values should be negative here to
denote an efflux of CO2.</p>
<p><em>Walker &amp; Ort (2015)</em></p>
<p>The <code>walker_ort_2015</code> model estimates light respiration and
\(\Gamma*\) according to Walker &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
A-C curves run at multiple light intensities. The method estimates
\(\Gamma*\) and \(R_\mathrm{d}\). If estimated  \(R_\mathrm{d}\) is
positive this could indicate issues (i.e. leaks) in the gas exchange
measurements. \(\Gamma*\) is in units of umol / mol and \(R_\mathrm{d}\)
is in units of \(\mu\)mol m\(^{-2}\) s\(^{-1}\) of respiratory flux.
If using \(C_\mathrm{i}\), the estimated value is technically \(C_\mathrm{i}\)*.
You need to use \(C_\mathrm{c}\) to get \(\Gamma*\) Also note, however,
that the convention in the field is to completely ignore this note.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234–244</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 3489–3499</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Walker &amp; Ort (2015) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">acq_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"walker_ort_2015"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .Q <span class="op">=</span> <span class="va">Qin</span>, .C <span class="op">=</span> <span class="va">Ci</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  C_upper <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Irradiance levels used in experiment</span></span></span>
<span class="r-in"><span>  Q_levels <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">750</span>, <span class="fl">375</span>, <span class="fl">125</span>, <span class="fl">100</span>, <span class="fl">75</span>, <span class="fl">50</span>, <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = `(Intercept)` ~ gamma_star, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.218920 -0.136553  0.007685  0.117016  0.249953 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.1949     0.1002  -1.945   0.0998 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma_star   44.3113     3.2518  13.627  9.7e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.1738 on 6 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9687,	Adjusted R-squared:  0.9635 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 185.7 on 1 and 6 DF,  p-value: 9.698e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  gamma_star </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.19485    44.31131 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="co">## n.b. these confidence intervals are not correct because the regression is fit </span></span></span>
<span class="r-in"><span><span class="co">## sequentially. It ignores the underlying data and uncertainty in estimates of </span></span></span>
<span class="r-in"><span><span class="co">## slopes and intercepts with each A-C curve. Use '.method = "brms"' to properly </span></span></span>
<span class="r-in"><span><span class="co">## calculate uncertainty. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %      97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.4400221  0.05032205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma_star  36.3544139 52.26820542</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic    p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">0.195</span>     0.100     -<span style="color: #BB0000;">1.94</span> 0.099<span style="text-decoration: underline;">8</span>       -<span style="color: #BB0000;">0.440</span>    0.050<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> gamma_star    44.3       3.25      13.6  0.000<span style="text-decoration: underline;">009</span>70   36.4     52.3   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1812764</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Yin et al. (2011) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"yin_etal_2011"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .phiPSII <span class="op">=</span> <span class="va">PhiPS2</span>, .Q <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Q_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  Q_upper <span class="op">=</span> <span class="fl">250</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = .A ~ x_var, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.8587 -0.4493  0.2041  0.7420  2.2232 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.77214    0.39419  -1.959   0.0549 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x_var        0.22661    0.02739   8.274 2.13e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.253 on 58 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.5414,	Adjusted R-squared:  0.5335 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 68.46 on 1 and 58 DF,  p-value: 2.129e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       x_var </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.7721399   0.2266078 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -1.5611923 0.01691245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x_var        0.1717862 0.28142935</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic  p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">0.772</span>    0.394      -<span style="color: #BB0000;">1.96</span> 5.49<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span>   -<span style="color: #BB0000;">1.56</span>     0.016<span style="text-decoration: underline;">9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> x_var          0.227    0.027<span style="text-decoration: underline;">4</span>      8.27 2.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>    0.172    0.281 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 91.04856</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kok (1956) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"kok_1956"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .Q <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Q_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  Q_upper <span class="op">=</span> <span class="fl">150</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = .A ~ .Q, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.1759 -0.4492  0.2077  0.6613  2.3544 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.523701   0.396419  -1.321    0.192    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .Q           0.036347   0.004781   7.602 2.85e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.309 on 58 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.4991,	Adjusted R-squared:  0.4905 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 57.79 on 1 and 58 DF,  p-value: 2.851e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          .Q </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.52370105  0.03634651 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -1.3172199 0.26981784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .Q           0.0267761 0.04591691</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic  p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)  -<span style="color: #BB0000;">0.524</span>    0.396       -<span style="color: #BB0000;">1.32</span> 1.92<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>  -<span style="color: #BB0000;">1.32</span>      0.270 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> .Q            0.036<span style="text-decoration: underline;">3</span>   0.004<span style="text-decoration: underline;">78</span>      7.60 2.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span>   0.026<span style="text-decoration: underline;">8</span>    0.045<span style="text-decoration: underline;">9</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 99.4385</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

