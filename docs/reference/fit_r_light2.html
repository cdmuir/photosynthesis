<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit models to estimate light respiration (\(R_\mathrm{d}\)) — fit_r_light2 • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit models to estimate light respiration (\(R_\mathrm{d}\)) — fit_r_light2"><meta name="description" content='We recommend using fit_photosynthesis() with argument .photo_fun = "r_light" rather than calling this function directly.'><meta property="og:description" content='We recommend using fit_photosynthesis() with argument .photo_fun = "r_light" rather than calling this function directly.'><meta property="og:image" content="https://github.com/cdmuir/photosynthesis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photosynthesis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/co2-response.html">Fitting CO2 response curves</a></li>
    <li><a class="dropdown-item" href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a></li>
    <li><a class="dropdown-item" href="../articles/light-respiration.html">Fit models to estimate light respiration</a></li>
    <li><a class="dropdown-item" href="../articles/light-response.html">Fitting light response curves</a></li>
    <li><a class="dropdown-item" href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a></li>
    <li><a class="dropdown-item" href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a></li>
    <li><a class="dropdown-item" href="../articles/pressure-volume.html">Fitting pressure-volume curves</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a></li>
    <li><a class="dropdown-item" href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-response.html">Fitting temperature response curves</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/cdmuir/photosynthesis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit models to estimate light respiration (\(R_\mathrm{d}\))</h1>
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_r_light.R"><code>R/fit_r_light.R</code></a></small>
      <div class="d-none name"><code>fit_r_light2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>We recommend using <code><a href="fit_photosynthesis.html">fit_photosynthesis()</a></code> with argument <code>.photo_fun = "r_light"</code> rather than calling this function directly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_r_light2</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  .model <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  .method <span class="op">=</span> <span class="st">"ls"</span>,</span>
<span>  Q_lower <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Q_upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  Q_levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  C_upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  brm_options <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing plant ecophysiological data. See <code><a href="required_variables.html">required_variables()</a></code> for the variables required for each model.</p></dd>


<dt id="arg--model">.model<a class="anchor" aria-label="anchor" href="#arg--model"></a></dt>
<dd><p>A character string of model name to use. See <code><a href="models.html">get_all_models()</a></code>.</p></dd>


<dt id="arg--method">.method<a class="anchor" aria-label="anchor" href="#arg--method"></a></dt>
<dd><p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm()</a></code>. Default is 'ls'.</p></dd>


<dt id="arg-q-lower">Q_lower<a class="anchor" aria-label="anchor" href="#arg-q-lower"></a></dt>
<dd><p>Lower light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models.</p></dd>


<dt id="arg-q-upper">Q_upper<a class="anchor" aria-label="anchor" href="#arg-q-upper"></a></dt>
<dd><p>Upper light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models</p></dd>


<dt id="arg-q-levels">Q_levels<a class="anchor" aria-label="anchor" href="#arg-q-levels"></a></dt>
<dd><p>A numeric vector of light intensity levels (\(\mu\)mol / mol) for estimating \(R_\mathrm{d}\) from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p></dd>


<dt id="arg-c-upper">C_upper<a class="anchor" aria-label="anchor" href="#arg-c-upper"></a></dt>
<dd><p>Upper C (\(\mu\)mol / mol) limit for estimating \(R_\mathrm{d}\) from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Flag. Should messages be suppressed? Default is FALSE.</p></dd>


<dt id="arg-brm-options">brm_options<a class="anchor" aria-label="anchor" href="#arg-brm-options"></a></dt>
<dd><p>A list of options passed to <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm()</a></code> if <code>.method = "brms"</code>. Default is NULL.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>If <code>.method = 'ls'</code>: an <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code> or <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> object.</p></li>
<li><p>If <code>.method = 'brms'</code>: a <code><a href="https://paulbuerkner.com/brms/reference/brmsfit-class.html" class="external-link">brms::brmsfit()</a></code> object.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Confusingly, \(R_\mathrm{d}\) typically denotes respiration in the light, but you might see \(R_\mathrm{day}\) or \(R_\mathrm{light}\).</p>
<p><strong>Models</strong></p>
<p><em>Kok (1956)</em></p>
<p>The <code>kok_1956</code> model estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. Rd value should be negative,
denoting an efflux of CO2.</p>
<p><em>Yin et al. (2011)</em></p>
<p>The <code>yin_etal_2011</code> model estimates light respiration according
to the Yin <em>et al.</em> (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Rd values should be negative here to
denote an efflux of CO2.</p>
<p><em>Walker &amp; Ort (2015)</em></p>
<p>The <code>walker_ort_2015</code> model estimates light respiration and
\(\Gamma*\) according to Walker &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
A-C curves run at multiple light intensities. The method estimates
\(\Gamma*\) and \(R_\mathrm{d}\). If estimated  \(R_\mathrm{d}\) is
positive this could indicate issues (i.e. leaks) in the gas exchange
measurements. \(\Gamma*\) is in units of umol / mol and \(R_\mathrm{d}\)
is in units of \(\mu\)mol m\(^{-2}\) s\(^{-1}\) of respiratory flux.
If using \(C_\mathrm{i}\), the estimated value is technically \(C_\mathrm{i}\)*.
You need to use \(C_\mathrm{c}\) to get \(\Gamma*\) Also note, however,
that the convention in the field is to completely ignore this note.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234–244</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 3489–3499</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Walker &amp; Ort (2015) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis">photosynthesis</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">acq_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span> <span class="op">|&gt;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"walker_ort_2015"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .Q <span class="op">=</span> <span class="va">Qin</span>, .C <span class="op">=</span> <span class="va">Ci</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  C_upper <span class="op">=</span> <span class="fl">300</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Irradiance levels used in experiment</span></span></span>
<span class="r-in"><span>  Q_levels <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1500</span>, <span class="fl">750</span>, <span class="fl">375</span>, <span class="fl">125</span>, <span class="fl">100</span>, <span class="fl">75</span>, <span class="fl">50</span>, <span class="fl">25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = `(Intercept)` ~ gamma_star, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Min        1Q    Median        3Q       Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.218920 -0.136553  0.007685  0.117016  0.249953 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.1949     0.1002  -1.945   0.0998 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma_star   44.3113     3.2518  13.627  9.7e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.1738 on 6 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9687,	Adjusted R-squared:  0.9635 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 185.7 on 1 and 6 DF,  p-value: 9.698e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  gamma_star </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.19485    44.31131 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="co">## n.b. these confidence intervals are not correct because the regression is fit </span></span></span>
<span class="r-in"><span><span class="co">## sequentially. It ignores the underlying data and uncertainty in estimates of </span></span></span>
<span class="r-in"><span><span class="co">## slopes and intercepts with each A-C curve. Use '.method = "brms"' to properly </span></span></span>
<span class="r-in"><span><span class="co">## calculate uncertainty. </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %      97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.4400221  0.05032205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma_star  36.3544139 52.26820542</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic    p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">0.195</span>     0.100     -<span style="color: #BB0000;">1.94</span> 0.099<span style="text-decoration: underline;">8</span>       -<span style="color: #BB0000;">0.440</span>    0.050<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> gamma_star    44.3       3.25      13.6  0.000<span style="text-decoration: underline;">009</span>70   36.4     52.3   </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1812764</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Yin et al. (2011) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"yin_etal_2011"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .phiPSII <span class="op">=</span> <span class="va">PhiPS2</span>, .Q <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Q_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  Q_upper <span class="op">=</span> <span class="fl">250</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = .A ~ x_var, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -3.8587 -0.4493  0.2041  0.7420  2.2232 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.77214    0.39419  -1.959   0.0549 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x_var        0.22661    0.02739   8.274 2.13e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.253 on 58 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.5414,	Adjusted R-squared:  0.5335 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 68.46 on 1 and 58 DF,  p-value: 2.129e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)       x_var </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.7721399   0.2266078 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -1.5611923 0.01691245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x_var        0.1717862 0.28142935</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic  p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)   -<span style="color: #BB0000;">0.772</span>    0.394      -<span style="color: #BB0000;">1.96</span> 5.49<span style="color: #949494;">e</span><span style="color: #BB0000;">- 2</span>   -<span style="color: #BB0000;">1.56</span>     0.016<span style="text-decoration: underline;">9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> x_var          0.227    0.027<span style="text-decoration: underline;">4</span>      8.27 2.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>    0.172    0.281 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 91.04856</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kok (1956) model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="fit_photosynthesis.html">fit_photosynthesis</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  .data <span class="op">=</span> <span class="va">acq_data</span>,</span></span>
<span class="r-in"><span>  .photo_fun <span class="op">=</span> <span class="st">"r_light"</span>,</span></span>
<span class="r-in"><span>  .model <span class="op">=</span> <span class="st">"kok_1956"</span>,</span></span>
<span class="r-in"><span>  .vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.A <span class="op">=</span> <span class="va">A</span>, .Q <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Q_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  Q_upper <span class="op">=</span> <span class="fl">150</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The 'fit' object inherits class 'lm' and many methods can be used</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = .A ~ .Q, data = .)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -4.1759 -0.4492  0.2077  0.6613  2.3544 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -0.523701   0.396419  -1.321    0.192    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .Q           0.036347   0.004781   7.602 2.85e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 1.309 on 58 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.4991,	Adjusted R-squared:  0.4905 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 57.79 on 1 and 58 DF,  p-value: 2.851e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimated parameters:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)          .Q </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.52370105  0.03634651 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 95% confidence intervals:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) -1.3172199 0.26981784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .Q           0.0267761 0.04591691</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tidy summary table using 'broom::tidy()'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">fit</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term        estimate std.error statistic  p.value conf.low conf.high</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> (Intercept)  -<span style="color: #BB0000;">0.524</span>    0.396       -<span style="color: #BB0000;">1.32</span> 1.92<span style="color: #949494;">e</span><span style="color: #BB0000;">- 1</span>  -<span style="color: #BB0000;">1.32</span>      0.270 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> .Q            0.036<span style="text-decoration: underline;">3</span>   0.004<span style="text-decoration: underline;">78</span>      7.60 2.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span>   0.026<span style="text-decoration: underline;">8</span>    0.045<span style="text-decoration: underline;">9</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate residual sum-of-squares</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 99.4385</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

