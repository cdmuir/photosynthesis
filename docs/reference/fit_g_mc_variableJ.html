<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fitting mesophyll conductance with the variable J method — fit_g_mc_variableJ • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting mesophyll conductance with the variable J method — fit_g_mc_variableJ"><meta name="description" content="Fitting mesophyll conductance with the variable J method"><meta property="og:description" content="Fitting mesophyll conductance with the variable J method"><meta property="og:image" content="https://github.com/cdmuir/photosynthesis/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photosynthesis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/co2-response.html">Fitting CO2 response curves</a></li>
    <li><a class="dropdown-item" href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a></li>
    <li><a class="dropdown-item" href="../articles/light-respiration.html">Fit models to estimate light respiration</a></li>
    <li><a class="dropdown-item" href="../articles/light-response.html">Fitting light response curves</a></li>
    <li><a class="dropdown-item" href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a></li>
    <li><a class="dropdown-item" href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a></li>
    <li><a class="dropdown-item" href="../articles/pressure-volume.html">Fitting pressure-volume curves</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a></li>
    <li><a class="dropdown-item" href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-response.html">Fitting temperature response curves</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/cdmuir/photosynthesis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting mesophyll conductance with the variable J method</h1>
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_g_mc_variableJ.R"><code>R/fit_g_mc_variableJ.R</code></a></small>
      <div class="d-none name"><code>fit_g_mc_variableJ.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fitting mesophyll conductance with the variable J method</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_g_mc_variableJ</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, J_etr <span class="op">=</span> <span class="st">"J_etr"</span>, C_i <span class="op">=</span> <span class="st">"C_i"</span>, PPFD <span class="op">=</span> <span class="st">"PPFD"</span>, phi_PSII</span>
<span>    <span class="op">=</span> <span class="st">"phi_PSII"</span><span class="op">)</span>,</span>
<span>  usealpha_Q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha_Q <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>  beta_Q <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">gamma_star</span>,</span>
<span>  <span class="va">R_d</span>,</span>
<span>  P <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Dataframe</p></dd>


<dt id="arg-varnames">varnames<a class="anchor" aria-label="anchor" href="#arg-varnames"></a></dt>
<dd><p>Variable names to fit g_mc. varnames = list(A_net = "A_net",
J_etr = "J_etr", C_i = "C_i", PPFD = "PPFD", phi_PSII = "phi_PSII"), where
A_net is net CO2 assimilation in umol m-2 s-1, J_etr is linear electron
transport flux in umol m-2 s-1, C_i is intercellular CO2 concentration in
umol mol-1, PPFD is incident irradiance in umol m-2 s-1, phi_PSII is
the operating efficiency of photosystem II.</p></dd>


<dt id="arg-usealpha-q">usealpha_Q<a class="anchor" aria-label="anchor" href="#arg-usealpha-q"></a></dt>
<dd><p>Recalculate electron transport with new absorbance value?</p></dd>


<dt id="arg-alpha-q">alpha_Q<a class="anchor" aria-label="anchor" href="#arg-alpha-q"></a></dt>
<dd><p>Absorbance of photosynthetically active radiation</p></dd>


<dt id="arg-beta-q">beta_Q<a class="anchor" aria-label="anchor" href="#arg-beta-q"></a></dt>
<dd><p>Partitioning of absorbed light energy between PSI and PSII</p></dd>


<dt id="arg-gamma-star">gamma_star<a class="anchor" aria-label="anchor" href="#arg-gamma-star"></a></dt>
<dd><p>Photorespiratory CO2 compensation point in umol mol-1</p></dd>


<dt id="arg-r-d">R_d<a class="anchor" aria-label="anchor" href="#arg-r-d"></a></dt>
<dd><p>Respiration rate in umol m-2 s-1</p></dd>


<dt id="arg-p">P<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>Atmospheric pressure in kPa</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>fit_g_mc_variableJ fits mesophyll conductance according
to Harley et al. 1992. It also tests the reliability of the
calculation and calculates a mean with only reliable values.
Note that the output is in units of umol m-2 s-1 Pa-1.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Harley PC, Loreto F, Di Marco G, Sharkey TD. 1992. Theoretical
considerations when estimating mesophyll conductance to CO2 flux
by analysis of the response of photosynthesis to CO2. Plant Physiol
98:1429 - 1436.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: there will be issues here if the alpha value used</span></span></span>
<span class="r-in"><span><span class="co"># for calculating ETR is off, if gamma_star is incorrect,</span></span></span>
<span class="r-in"><span><span class="co"># if R_d is incorrect.</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fit_g_mc_variableJ</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    J_etr <span class="op">=</span> <span class="st">"ETR"</span>,</span></span>
<span class="r-in"><span>    C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span></span>
<span class="r-in"><span>    PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span></span>
<span class="r-in"><span>    phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  gamma_star <span class="op">=</span> <span class="fl">46</span>,</span></span>
<span class="r-in"><span>  R_d <span class="op">=</span> <span class="fl">0.153</span>,</span></span>
<span class="r-in"><span>  usealpha_Q <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  alpha_Q <span class="op">=</span> <span class="fl">0.84</span>,</span></span>
<span class="r-in"><span>  beta_Q <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  P <span class="op">=</span> <span class="fl">84</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that many g_mc values from this method can be unreliable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">g_mc</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"("</span> <span class="op">*</span> <span class="va">mu</span> <span class="op">*</span> <span class="va">mol</span> <span class="op">~</span> <span class="va">mol</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">g</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="op">~</span> <span class="st">"(mol"</span> <span class="op">~</span> <span class="va">m</span><span class="op">^</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="op">~</span> <span class="va">s</span><span class="op">^</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="op">~</span> <span class="va">Pa</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_g_mc_variableJ-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot QAQC graph according to Harley et al. 1992</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">dCcdA</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"("</span> <span class="op">*</span> <span class="va">mu</span> <span class="op">*</span> <span class="va">mol</span> <span class="op">~</span> <span class="va">mol</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">*</span> <span class="va">C</span><span class="op">[</span><span class="va">chl</span><span class="op">]</span> <span class="op">*</span> <span class="st">"/"</span> <span class="op">*</span> <span class="va">delta</span> <span class="op">*</span> <span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_g_mc_variableJ-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

