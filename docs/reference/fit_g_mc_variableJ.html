<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting mesophyll conductance with the variable J method — fit_g_mc_variableJ • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting mesophyll conductance with the variable J method — fit_g_mc_variableJ"><meta property="og:description" content="Fitting mesophyll conductance with the variable J method"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.2.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/co2-response.html">Fitting CO2 response curves</a>
    </li>
    <li>
      <a href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a>
    </li>
    <li>
      <a href="../articles/light-respiration.html">Fit models to estimate light respiration</a>
    </li>
    <li>
      <a href="../articles/light-response.html">Fitting light response curves</a>
    </li>
    <li>
      <a href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a>
    </li>
    <li>
      <a href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
    <li>
      <a href="../articles/pressure-volume.html">Fitting pressure-volume curves</a>
    </li>
    <li>
      <a href="../articles/sensitivity-analysis.html">Sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a>
    </li>
    <li>
      <a href="../articles/temperature-response.html">Fitting temperature response curves</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting mesophyll conductance with the variable J method</h1>
    <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_g_mc_variableJ.R" class="external-link"><code>R/fit_g_mc_variableJ.R</code></a></small>
    <div class="hidden name"><code>fit_g_mc_variableJ.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fitting mesophyll conductance with the variable J method</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_g_mc_variableJ</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, J_etr <span class="op">=</span> <span class="st">"J_etr"</span>, C_i <span class="op">=</span> <span class="st">"C_i"</span>, PPFD <span class="op">=</span> <span class="st">"PPFD"</span>, phi_PSII</span>
<span>    <span class="op">=</span> <span class="st">"phi_PSII"</span><span class="op">)</span>,</span>
<span>  usealpha_Q <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  alpha_Q <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>  beta_Q <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  <span class="va">gamma_star</span>,</span>
<span>  <span class="va">R_d</span>,</span>
<span>  P <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Dataframe</p></dd>


<dt>varnames</dt>
<dd><p>Variable names to fit g_mc. varnames = list(A_net = "A_net",
J_etr = "J_etr", C_i = "C_i", PPFD = "PPFD", phi_PSII = "phi_PSII"), where
A_net is net CO2 assimilation in umol m-2 s-1, J_etr is linear electron
transport flux in umol m-2 s-1, C_i is intercellular CO2 concentration in
umol mol-1, PPFD is incident irradiance in umol m-2 s-1, phi_PSII is
the operating efficiency of photosystem II.</p></dd>


<dt>usealpha_Q</dt>
<dd><p>Recalculate electron transport with new absorbance value?</p></dd>


<dt>alpha_Q</dt>
<dd><p>Absorbance of photosynthetically active radiation</p></dd>


<dt>beta_Q</dt>
<dd><p>Partitioning of absorbed light energy between PSI and PSII</p></dd>


<dt>gamma_star</dt>
<dd><p>Photorespiratory CO2 compensation point in umol mol-1</p></dd>


<dt>R_d</dt>
<dd><p>Respiration rate in umol m-2 s-1</p></dd>


<dt>P</dt>
<dd><p>Atmospheric pressure in kPa</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>fit_g_mc_variableJ fits mesophyll conductance according
to Harley et al. 1992. It also tests the reliability of the
calculation and calculates a mean with only reliable values.
Note that the output is in units of umol m-2 s-1 Pa-1.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Harley PC, Loreto F, Di Marco G, Sharkey TD. 1992. Theoretical
considerations when estimating mesophyll conductance to CO2 flux
by analysis of the response of photosynthesis to CO2. Plant Physiol
98:1429 - 1436.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: there will be issues here if the alpha value used</span></span></span>
<span class="r-in"><span><span class="co"># for calculating ETR is off, if gamma_star is incorrect,</span></span></span>
<span class="r-in"><span><span class="co"># if R_d is incorrect.</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fit_g_mc_variableJ</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    J_etr <span class="op">=</span> <span class="st">"ETR"</span>,</span></span>
<span class="r-in"><span>    C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span></span>
<span class="r-in"><span>    PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span></span>
<span class="r-in"><span>    phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  gamma_star <span class="op">=</span> <span class="fl">46</span>,</span></span>
<span class="r-in"><span>  R_d <span class="op">=</span> <span class="fl">0.153</span>,</span></span>
<span class="r-in"><span>  usealpha_Q <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  alpha_Q <span class="op">=</span> <span class="fl">0.84</span>,</span></span>
<span class="r-in"><span>  beta_Q <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  P <span class="op">=</span> <span class="fl">84</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note that many g_mc values from this method can be unreliable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">g_mc</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"("</span> <span class="op">*</span> <span class="va">mu</span> <span class="op">*</span> <span class="va">mol</span> <span class="op">~</span> <span class="va">mol</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">g</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="op">~</span> <span class="st">"(mol"</span> <span class="op">~</span> <span class="va">m</span><span class="op">^</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="op">~</span> <span class="va">s</span><span class="op">^</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="op">~</span> <span class="va">Pa</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_g_mc_variableJ-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot QAQC graph according to Harley et al. 1992</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">dCcdA</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="st">"("</span> <span class="op">*</span> <span class="va">mu</span> <span class="op">*</span> <span class="va">mol</span> <span class="op">~</span> <span class="va">mol</span><span class="op">^</span></span></span>
<span class="r-in"><span>      <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span>      <span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">*</span> <span class="va">C</span><span class="op">[</span><span class="va">chl</span><span class="op">]</span> <span class="op">*</span> <span class="st">"/"</span> <span class="op">*</span> <span class="va">delta</span> <span class="op">*</span> <span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_g_mc_variableJ-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

