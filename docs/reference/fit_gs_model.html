<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fitting stomatal conductance models — fit_gs_model • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting stomatal conductance models — fit_gs_model"><meta property="og:description" content="Fitting stomatal conductance models"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/photosynthesis-curve-fitting-sensitivity-analyses.html">photosynthesis-curve-fitting-sensitivity-analyses</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting stomatal conductance models</h1>
    <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_gs_model.R" class="external-link"><code>R/fit_gs_model.R</code></a></small>
    <div class="hidden name"><code>fit_gs_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fitting stomatal conductance models</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_gs_model</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, C_air <span class="op">=</span> <span class="st">"C_air"</span>, g_sw <span class="op">=</span> <span class="st">"g_sw"</span>, RH <span class="op">=</span> <span class="st">"RH"</span>, VPD <span class="op">=</span></span>
<span>    <span class="st">"VPD"</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BallBerry"</span>, <span class="st">"Leuning"</span>, <span class="st">"Medlyn_partial"</span>, <span class="st">"Medlyn_full"</span><span class="op">)</span>,</span>
<span>  D0 <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Dataframe</p></dd>


<dt>varnames</dt>
<dd><p>Variable names</p>
<p>For the Ball-Berry model: varnames = list(A_net = "A_net", C_air = "C_air",
g_sw = "g_sw", RH = "RH") where A_net is net CO2 assimilation, C_air is CO2
concentration at the leaf surface in umol mol-1, g_sw is stomatal
conductance to H2O, and RH is relative humidity as a proportion.</p>
<p>For the Leuning model: varnames = list(A_net = "A_net", C_air = "C_air",
g_sw = "g_sw", VPD = "VPD") where A_net is net CO2 assimilation, C_air is
CO2 concentration at the leaf surface in umol mol-1, g_sw is stomatal
conductance to H2O, and VPD is leaf to air vapor pressure deficit in kPa.</p>
<p>For the Medlyn et al. 2011 models: varnames = list(A_net = "A_net",
C_air = "C_air", g_sw = "g_sw", VPD = "VPD") where A_net is net CO2
assimilation, C_air is CO2 concentration at the leaf surface in umol mol-1,
g_sw is stomatal conductance to H2O, and VPD is leaf to air vapor pressure
deficit in kPa.</p></dd>


<dt>model</dt>
<dd><p>Which model(s) to fit? Defaults to all models. Available
options are "BallBerry", "Leuning", "Medlyn_partial", and "Medlyn_full",
from Ball et al. (1987), Leuning (1995), and Medlyn et al. (2011).</p></dd>


<dt>D0</dt>
<dd><p>Vapor pressure sensitivity of stomata (Leuning 1995)</p></dd>


<dt>...</dt>
<dd><p>Arguments to pass on to the nlsLM() function for the Medlyn
models.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>fit_gs_model fits one or more stomatal conductance models to the
data. The top level of the output list is named after the fitted model,
while the second level contains the Model, Parameters, and Graph, in that
order.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ball JT, Woodrow IE, Berry JA. 1987. A model predicting stomatal
conductance and its contribution to the control of photosynthesis
under different environmental conditions, in Progress in
Photosynthesis Research, Proceedings of the VII International
Congress on Photosynthesis, vol. 4, edited by I. Biggins, pp.
221–224, Martinus Nijhoff, Dordrecht, Netherlands.</p>
<p>Leuning R. 1995. A critical appraisal of a coupled stomatal-
photosynthesis model for C3 plants. Plant Cell Environ 18:339-357</p>
<p>Medlyn BE, Duursma RA, Eamus D, Ellsworth DS, Prentice IC, Barton
CVM, Crous KY, Angelis PD, Freeman M, Wingate L. 2011. Reconciling
the optimal and empirical approaches to modeling stomatal
conductance. Glob Chang Biol 17:2134-2144</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert RH to a proportion</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">RH</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">RHcham</span> <span class="op">/</span> <span class="fl">100</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit stomatal conductance models</span></span></span>
<span class="r-in"><span><span class="co"># Can specify a single model, or all as below</span></span></span>
<span class="r-in"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu">fit_gs_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    C_air <span class="op">=</span> <span class="st">"Ca"</span>,</span></span>
<span class="r-in"><span>    g_sw <span class="op">=</span> <span class="st">"gsw"</span>,</span></span>
<span class="r-in"><span>    RH <span class="op">=</span> <span class="st">"RH"</span>,</span></span>
<span class="r-in"><span>    VPD <span class="op">=</span> <span class="st">"VPDleaf"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"BallBerry"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Leuning"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Medlyn_partial"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Medlyn_full"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  D0 <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at BallBerry model summary:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = g_sw ~ gs_mod_ballberry(A_net = A_net, C_air = C_air, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     RH = RH), data = data)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1516 -0.1007 -0.0557  0.1372  0.2498 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                          Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                                             1.481e-01  1.471e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gs_mod_ballberry(A_net = A_net, C_air = C_air, RH = RH) 1.627e-05  2.832e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                                              10.062  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gs_mod_ballberry(A_net = A_net, C_air = C_air, RH = RH)   5.744 1.13e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.1248 on 94 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.2598,	Adjusted R-squared:  0.2519 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 32.99 on 1 and 94 DF,  p-value: 1.132e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at BallBerry parameters</span></span></span>
<span class="r-in"><span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Parameters"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          g0          g1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1480627 1.62664e-05</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at BallBerry plot</span></span></span>
<span class="r-in"><span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-plt img"><img src="fit_gs_model-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit many g_sw models</span></span></span>
<span class="r-in"><span><span class="co"># Set your grouping variable</span></span></span>
<span class="r-in"><span><span class="co"># Here we are grouping by Qin and individual</span></span></span>
<span class="r-in"><span><span class="va">data</span><span class="op">$</span><span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Qin</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="fit_many.html">fit_many</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    C_air <span class="op">=</span> <span class="st">"Ca"</span>,</span></span>
<span class="r-in"><span>    g_sw <span class="op">=</span> <span class="st">"gsw"</span>,</span></span>
<span class="r-in"><span>    RH <span class="op">=</span> <span class="st">"RH"</span>,</span></span>
<span class="r-in"><span>    VPD <span class="op">=</span> <span class="st">"VPDleaf"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  funct <span class="op">=</span> <span class="va">fit_gs_model</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="st">"Q_2"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%Error in nlsModel(formula, mf, start, wts) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   singular gradient matrix at initial parameter estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |=========                                                             |  12%  |                                                                              |==================                                                    |  25%  |                                                                              |==========================                                            |  38%  |                                                                              |===================================                                   |  50%  |                                                                              |============================================                          |  62%  |                                                                              |====================================================                  |  75%  |                                                                              |=============================================================         |  88%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at the Medlyn_partial outputs at 750 PAR</span></span></span>
<span class="r-in"><span><span class="co"># Model summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: g_sw ~ gs_mod_opti(A_net = A_net, C_air = C_air, VPD = VPD, g0, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     g1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g0  0.38778    0.03317  11.692 3.73e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g1 -1.09754    0.83022  -1.322    0.216    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.04375 on 10 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of iterations to convergence: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Achieved convergence tolerance: 1.49e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model parameters</span></span></span>
<span class="r-in"><span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Parameters"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          g0        g1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3877773 -1.097544</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Graph</span></span></span>
<span class="r-in"><span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-plt img"><img src="fit_gs_model-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compile parameter outputs for BallBerry model</span></span></span>
<span class="r-in"><span><span class="co"># Note that it's the first element for each PAR value</span></span></span>
<span class="r-in"><span><span class="co"># First compile list of BallBerry fits</span></span></span>
<span class="r-in"><span><span class="va">bbmods</span> <span class="op">&lt;-</span> <span class="fu"><a href="compile_data.html">compile_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">fits</span>,</span></span>
<span class="r-in"><span>  output_type <span class="op">=</span> <span class="st">"list"</span>,</span></span>
<span class="r-in"><span>  list_element <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Now compile the parameters (2nd element) into a dataframe</span></span></span>
<span class="r-in"><span><span class="va">bbpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="compile_data.html">compile_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">bbmods</span>,</span></span>
<span class="r-in"><span>  output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span></span>
<span class="r-in"><span>  list_element <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert group variable back to numeric</span></span></span>
<span class="r-in"><span><span class="va">bbpars</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bbpars</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Take quick look at light response of intercept parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g0</span> <span class="op">~</span> <span class="va">ID</span>, <span class="va">bbpars</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_gs_model-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compile graphs</span></span></span>
<span class="r-in"><span><span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="compile_data.html">compile_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">bbmods</span>,</span></span>
<span class="r-in"><span>  output_type <span class="op">=</span> <span class="st">"list"</span>,</span></span>
<span class="r-in"><span>  list_element <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at 3rd graph</span></span></span>
<span class="r-in"><span><span class="va">graphs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-plt img"><img src="fit_gs_model-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer></div>

  


  

  </body></html>

