<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimating light respiration — fit_r_light_kok • photosynthesis</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating light respiration — fit_r_light_kok"><meta property="og:description" content="Estimating light respiration"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/modeling-recommemdations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-curve-fitting-sensitivity-analyses.html">Photosynthesis curve-fitting and sensitivity analyses</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimating light respiration</h1>
    <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/R/fit_r_light.R" class="external-link"><code>R/fit_r_light.R</code></a></small>
    <div class="hidden name"><code>fit_r_light.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimating light respiration</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_r_light_kok</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, PPFD <span class="op">=</span> <span class="st">"PPFD"</span><span class="op">)</span>,</span>
<span>  PPFD_lower <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  PPFD_upper <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fit_r_light_WalkerOrt</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, C_i <span class="op">=</span> <span class="st">"C_i"</span>, PPFD <span class="op">=</span> <span class="st">"PPFD"</span><span class="op">)</span>,</span>
<span>  P <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  C_i_threshold <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fit_r_light_yin</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A_net"</span>, PPFD <span class="op">=</span> <span class="st">"PPFD"</span>, phi_PSII <span class="op">=</span> <span class="st">"phi_PSII"</span><span class="op">)</span>,</span>
<span>  PPFD_lower <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  PPFD_upper <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Dataframe</p></dd>


<dt>varnames</dt>
<dd><p>List of variable names</p></dd>


<dt>PPFD_lower</dt>
<dd><p>Lower light intensity limit for estimating Rlight
(Kok &amp; Yin)</p></dd>


<dt>PPFD_upper</dt>
<dd><p>Upper light intensity limit for estimating Rlight
(Kok &amp; Yin)</p></dd>


<dt>P</dt>
<dd><p>Atmospheric pressure in kPa (Walker &amp; Ort, 2015)</p></dd>


<dt>C_i_threshold</dt>
<dd><p>Threshold C_i (in umol mol-1) to cut data to
linear region for fitting light respiration and gamma_star
(Walker &amp; Ort, 2015)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>fit_r_light_kok estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. r_light value should be negative,
denoting an efflux of CO2.</p>


<p>fit_r_light_WalkerOrt estimates light respiration and
GammaStar according to Walk &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
ACi curves run at multiple light intensities. Output GammaStar and
respiration should be negative If output respiration is positive
this could indicate issues (i.e. leaks) in the gas exchange
measurements. GammaStar is output in umol mol-1, and respiration
is output in umol m-2 s-1 of respiratory flux. Output is a list
containing the slope intercept regression model, a graph of the fit,
and estimates of the coefficients. NOTE: if using C_i, the output value
is technically C_istar. You need to use Cc to get GammaStar. Also note,
however, that the convention in the field is to completely ignore this note.</p>


<p>fit_r_light_yin estimates light respiration according
to the Yin et al. (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Note that respiration
output should be negative here to denote an efflux of CO2.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234–244</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 3489–3499</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># FITTING KOK METHOD</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit light respiration with Kok method</span></span></span>
<span class="r-in"><span><span class="va">r_light</span> <span class="op">&lt;-</span> <span class="fu">fit_r_light_kok</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    PPFD <span class="op">=</span> <span class="st">"Qin"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  PPFD_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  PPFD_upper <span class="op">=</span> <span class="fl">150</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Return r_light</span></span></span>
<span class="r-in"><span><span class="va">r_light</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.5237011 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># FITTING WALKER-ORT METHOD</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the Walker-Ort method for GammaStar and light respiration</span></span></span>
<span class="r-in"><span><span class="va">walker_ort</span> <span class="op">&lt;-</span> <span class="fu">fit_r_light_WalkerOrt</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span></span>
<span class="r-in"><span>    PPFD <span class="op">=</span> <span class="st">"Qin"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Extract model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = Intercept ~ Slope, data = coefs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Min       1Q   Median       3Q      Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.36114 -0.10958 -0.05553  0.08166  0.62016 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  -0.1526     0.1176  -1.297    0.224    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope        -4.6004     0.4069 -11.307  5.1e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 0.2513 on 10 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9275,	Adjusted R-squared:  0.9202 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 127.8 on 1 and 10 DF,  p-value: 5.103e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View graph</span></span></span>
<span class="r-in"><span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `geom_smooth()` using formula = 'y ~ x'</span>
<span class="r-plt img"><img src="fit_r_light-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View coefficients</span></span></span>
<span class="r-in"><span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       GammaStar   r_light</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slope  46.00427 -0.152643</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># FITTING THE YIN METHOD</span></span></span>
<span class="r-in"><span><span class="co"># Read in your data</span></span></span>
<span class="r-in"><span><span class="co"># Note that this data is coming from data supplied by the package</span></span></span>
<span class="r-in"><span><span class="co"># hence the complicated argument in read.csv()</span></span></span>
<span class="r-in"><span><span class="co"># This dataset is a CO2 by light response curve for a single sunflower</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"photosynthesis"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit light respiration with Yin method</span></span></span>
<span class="r-in"><span><span class="va">r_light</span> <span class="op">&lt;-</span> <span class="fu">fit_r_light_yin</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    A_net <span class="op">=</span> <span class="st">"A"</span>,</span></span>
<span class="r-in"><span>    PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span></span>
<span class="r-in"><span>    phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  PPFD_lower <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  PPFD_upper <span class="op">=</span> <span class="fl">250</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

