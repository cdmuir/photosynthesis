<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>photosynthesis-curve-fitting-sensitivity-analyses • photosynthesis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="photosynthesis-curve-fitting-sensitivity-analyses">
<meta property="og:description" content="photosynthesis">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/photosynthesis-curve-fitting-sensitivity-analyses.html">photosynthesis-curve-fitting-sensitivity-analyses</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>photosynthesis-curve-fitting-sensitivity-analyses</h1>
                        <h4 data-toc-skip class="author">Joseph R.
Stinziano</h4>
            
            <h4 data-toc-skip class="date">2022-07-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/vignettes/photosynthesis-curve-fitting-sensitivity-analyses.Rmd" class="external-link"><code>vignettes/photosynthesis-curve-fitting-sensitivity-analyses.Rmd</code></a></small>
      <div class="hidden name"><code>photosynthesis-curve-fitting-sensitivity-analyses.Rmd</code></div>

    </div>

    
    
<p>This vignette is designed to demonstrate how to use the curve fitting
and sensitivity analysis tools Sections are named based on the set of
methods to be used:</p>
<ol style="list-style-type: decimal">
<li><p>Fitting light response curves</p></li>
<li><p>Fitting CO2 response curves</p></li>
<li><p>Fitting temperature response curves (Need data &amp; to complete
tutorial here)</p></li>
<li><p>Fitting stomatal conductance models</p></li>
<li><p>Fitting light respiration</p></li>
<li><p>Fitting mesophyll conductance</p></li>
<li><p>Fitting pressure-volume curves</p></li>
<li><p>Fitting hydraulic vulnerability curves</p></li>
<li><p>Sensitivity analyses (just need to think about measures of
sensitivity &amp; multi fits)</p></li>
<li><p>Dependency checking</p></li>
</ol>
<p>Components under construction:</p>
<ol style="list-style-type: decimal">
<li><p>Full Gu-type CO2 response fitting</p></li>
<li><p>alphag fitting</p></li>
<li><p>Busch et al (2018) CO2 response model</p></li>
</ol>
<p>Within each section, data will either be generated or used from an
installed dataset within the package. For help with a given function,
please consult the help file via: ?functionname in the console. If you
want to know the fine details of the code, please go to:</p>
<p><a href="https://github.com/jstinzi/photosynthesis" class="external-link uri">https://github.com/jstinzi/photosynthesis</a></p>
<p>And look in the R folder to find the raw function files. These
contain heavily annotated code that explains the why and how of their
operation.</p>
<p>#Installing the package</p>
<p>You will need the following packages:</p>
<p>devtools - lets you install packages from Github and Bitbucket</p>
<p>minpack.lm - useful for nonlinear curve fitting that is more robust
than base R</p>
<p>tidyverse - set of tools for manipulating data within R</p>
<p>FOR WINDOWS USERS</p>
<p>You will need to install Rtools, available at:</p>
<p><a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link uri">https://cran.r-project.org/bin/windows/Rtools/</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#To install, run the following without comments</span></span>
<span><span class="co">#library(devtools)</span></span>
<span><span class="co">#install_github("jstinzi/photosynthesis")</span></span>
<span></span>
<span><span class="co">#Load package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ggplot2</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: minpack.lm</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: units</span></span></code></pre>
<pre><code><span><span class="co">## udunits database from /usr/local/share/udunits/udunits2.xml</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#To cite, use:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"photosynthesis"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in person1(given = given[[i]], family = family[[i]], middle =</span></span>
<span><span class="co">## middle[[i]], : It is recommended to use 'given' instead of 'middle'.</span></span>
<span></span>
<span><span class="co">## Warning in person1(given = given[[i]], family = family[[i]], middle =</span></span>
<span><span class="co">## middle[[i]], : It is recommended to use 'given' instead of 'middle'.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## To cite photosynthesis in publications use:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Stinziano JR, Roback C, Gamble D, Murphy B, Hudson P, Muir CD.</span></span>
<span><span class="co">##   (2020). photosynthesis: tools for plant ecophysiology &amp; modeling. R</span></span>
<span><span class="co">##   package version 2.0.1.</span></span>
<span><span class="co">##   https://CRAN.R-project.org/package=photosynthesis.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Misc{,</span></span>
<span><span class="co">##     title = {photosynthesis: tools for plant ecophysiology &amp; modeling},</span></span>
<span><span class="co">##     author = {Joseph R Stinziano and Cassaundra Roback and Demi Gamble and Bridget Murphy and Patrick Hudson and Christopher D Muir},</span></span>
<span><span class="co">##     note = {R package version 2.0.1},</span></span>
<span><span class="co">##     year = {2020},</span></span>
<span><span class="co">##     url = {https://CRAN.R-project.org/package=photosynthesis},</span></span>
<span><span class="co">##   }</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load tidyr - needed for vignette manipulations</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<p>#Reading Li-Cor data</p>
<p>If you are trying to read in the raw data files of the Li-Cor 6400 or
6800 models, you can use the package RLicor by Erik Erhardt available on
Github.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#library(devtools)</span></span>
<span><span class="co">#install_github("erikerhardt/RLicor")</span></span>
<span><span class="co">#library(RLicor)</span></span>
<span></span>
<span><span class="co">#The following will detect and read Li-Cor 6400 and 6800 files</span></span>
<span><span class="co">#?read_Licor</span></span>
<span></span>
<span><span class="co">#To cite, use:</span></span>
<span><span class="co">#citation("RLicor")</span></span></code></pre></div>
<p>#1. Fitting light response curves</p>
<p>This package currently only implements the Marshall et al. 1980
non-rectangular hyperbola model of the photosynthetic light
response.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in your data</span></span>
<span><span class="co">#Note that this data is coming from data supplied by the package</span></span>
<span><span class="co">#hence the complicated argument in read.csv()</span></span>
<span><span class="co">#This dataset is a CO2 by light response curve for a single sunflower</span></span>
<span><span class="co">#Note that to read in your own data, you will need to delete the</span></span>
<span><span class="co">#system.file() function, otherwise you will get an error</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>,</span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit many AQ curves</span></span>
<span><span class="co">#Set your grouping variable</span></span>
<span><span class="co">#Here we are grouping by CO2_s and individual</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span> <span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">CO2_s</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#For this example we need to round sequentially due to CO2_s setpoints</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span>, digits <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#To fit one AQ curve</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_aq_response.html">fit_aq_response</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span> <span class="op">==</span> <span class="fl">600</span>,<span class="op">]</span>,</span>
<span>                       varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                         PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                       Q_cut <span class="op">=</span> <span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Print model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Formula: A_net ~ aq_response(k_sat, phi_J, Q_abs = data$Q_abs, theta_J) - </span></span>
<span><span class="co">##     Rd</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## k_sat          21.167200   0.158332  133.69 1.88e-08 ***</span></span>
<span><span class="co">## phi_J.Q_abs     0.051907   0.001055   49.18 1.02e-06 ***</span></span>
<span><span class="co">## theta_J         0.775484   0.014920   51.98 8.20e-07 ***</span></span>
<span><span class="co">## Rd.(Intercept)  0.668495   0.065235   10.25 0.000511 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.05535 on 4 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of iterations to convergence: 5 </span></span>
<span><span class="co">## Achieved convergence tolerance: 1.49e-08</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print fitted parameters</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##         A_sat      phi_J   theta_J        Rd      LCP  resid_SSs</span></span>
<span><span class="co">## k_sat 21.1672 0.05190746 0.7754836 0.6684953 12.97289 0.01225491</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print graph</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Fit many curves</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                 varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                         PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                         group <span class="op">=</span> <span class="st">"C_s"</span><span class="op">)</span>,</span>
<span>                 funct <span class="op">=</span> <span class="va">fit_aq_response</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"C_s"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Look at model summary for a given fit</span></span>
<span><span class="co">#First set of double parentheses selects an individual group value</span></span>
<span><span class="co">#Second set selects an element of the sublist</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Formula: A_net ~ aq_response(k_sat, phi_J, Q_abs = data$Q_abs, theta_J) - </span></span>
<span><span class="co">##     Rd</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## k_sat          7.347423   0.141931  51.768 8.33e-07 ***</span></span>
<span><span class="co">## phi_J.Q_abs    0.027192   0.001511  17.994 5.61e-05 ***</span></span>
<span><span class="co">## theta_J        0.837778   0.030608  27.371 1.06e-05 ***</span></span>
<span><span class="co">## Rd.(Intercept) 0.615283   0.086994   7.073  0.00211 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.06799 on 4 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of iterations to convergence: 4 </span></span>
<span><span class="co">## Achieved convergence tolerance: 1.49e-08</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print the parameters</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##          A_sat      phi_J   theta_J        Rd      LCP  resid_SSs</span></span>
<span><span class="co">## k_sat 2.637157 0.01458002 0.8858892 0.5951635 42.17813 0.02446394</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print the graph</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile graphs into a list for plotting</span></span>
<span><span class="va">fits_graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>,</span>
<span>                            list_element <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Print graphs to jpeg</span></span>
<span><span class="co"># print_graphs(data = fits_graphs,</span></span>
<span><span class="co">#             path = tempdir(),</span></span>
<span><span class="co">#             output_type = "jpeg")</span></span>
<span></span>
<span><span class="co">#Compile parameters into dataframe for analysis</span></span>
<span><span class="va">fits_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>,</span>
<span>                          output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                          list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>#2. Fitting CO2 response curves</p>
<p>This package currently implements a Gu-type fitting procedure for CO2
response curves similar to the Duursma (2015) implementation. There is
ongoing work to implement a full Gu-type method whereby mesophyll
conductance, Km, and GammaStar could all be fit (Gu et al 2010). There
is also ongoing work to implement a procedure to fit alphag for the
TPU-limited region and to incorporate the Sharkey (2019) suggestion of
using chlorophyll fluorescence data to inform TPU limitations.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in your data</span></span>
<span><span class="co">#Note that this data is coming from data supplied by the package</span></span>
<span><span class="co">#hence the complicated argument in read.csv()</span></span>
<span><span class="co">#This dataset is a CO2 by light response curve for a single sunflower</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Define a grouping factor based on light intensity to split the ACi</span></span>
<span><span class="co">#curves</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Qin</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Convert data temperature to K</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">T_leaf</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Tleaf</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span></span>
<span><span class="co">#Fit ACi curve. Note that we are subsetting the dataframe</span></span>
<span><span class="co">#here to fit for a single value of Q_2</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_aci_response.html">fit_aci_response</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">Q_2</span> <span class="op">==</span> <span class="fl">1500</span>, <span class="op">]</span>,</span>
<span>                        varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                      T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span>,</span>
<span>                                      C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span>
<span>                                      PPFD <span class="op">=</span> <span class="st">"Qin"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#View fitted parameters</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   Num V_cmax V_cmax_se    J_max        J      J_se V_TPU V_TPU_se        R_d</span></span>
<span><span class="co">## 6   0 62.797  2.176227 110.3051 103.9718 0.1847135  1000       NA -0.3470509</span></span>
<span><span class="co">##      R_d_se     cost citransition1 citransition2 V_cmax_pts J_max_pts V_TPU_pts</span></span>
<span><span class="co">## 6 0.3947545 1.063979      427.6839      1450.485          8         4         0</span></span>
<span><span class="co">##   alpha alpha_g gamma_star25 Ea_gamma_star K_M25   Ea_K_M  g_mc25 Ea_g_mc Oconc</span></span>
<span><span class="co">## 6  0.24       0        42.75         37830 718.4 65508.28 0.08701       0    21</span></span>
<span><span class="co">##   theta_J</span></span>
<span><span class="co">## 6    0.85</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View graph</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 2 row(s) containing missing values (geom_path).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 12 row(s) containing missing values (geom_path).</span></span></code></pre>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View data with modeled parameters attached</span></span>
<span><span class="co">#fit[[3]]</span></span>
<span></span>
<span><span class="co">#Fit many curves</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                 varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                      T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span>,</span>
<span>                                      C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span>
<span>                                      PPFD <span class="op">=</span> <span class="st">"Qin"</span><span class="op">)</span>,</span>
<span>                 funct <span class="op">=</span> <span class="va">fit_aci_response</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"Q_2"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print the parameters</span></span>
<span><span class="co">#First set of double parentheses selects an individual group value</span></span>
<span><span class="co">#Second set selects an element of the sublist</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   Num  V_cmax V_cmax_se    J_max        J       J_se V_TPU V_TPU_se        R_d</span></span>
<span><span class="co">## 6   0 8.94862 0.5509706 47.01527 16.63315 0.08692268  1000       NA -0.1565895</span></span>
<span><span class="co">##      R_d_se      cost citransition1 citransition2 V_cmax_pts J_max_pts</span></span>
<span><span class="co">## 6 0.1264438 0.1194886      441.2967      1442.493          8         4</span></span>
<span><span class="co">##   V_TPU_pts alpha alpha_g gamma_star25 Ea_gamma_star K_M25   Ea_K_M  g_mc25</span></span>
<span><span class="co">## 6         0  0.24       0        42.75         37830 718.4 65508.28 0.08701</span></span>
<span><span class="co">##   Ea_g_mc Oconc theta_J</span></span>
<span><span class="co">## 6       0    21    0.85</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Print the graph</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 12 row(s) containing missing values (geom_path).</span></span></code></pre>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile graphs into a list for plotting</span></span>
<span><span class="va">fits_graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>,</span>
<span>                            list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Print graphs to jpeg</span></span>
<span><span class="co"># print_graphs(data = fits_graphs,</span></span>
<span><span class="co">#             path = tempdir(),</span></span>
<span><span class="co">#             output_type = "jpeg")</span></span>
<span></span>
<span><span class="co">#Compile parameters into dataframe for analysis</span></span>
<span><span class="va">fits_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>,</span>
<span>                          output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                          list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>#3. Fitting temperature response curves</p>
<p>This package provides support for multiple temperature response
functions (Arrhenius 1915; Medlyn et al. 2002; Kruse &amp; Adams. 2006;
Heskel et al. 2016; Liang et al. 2018).</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_T_data.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span>,</span>
<span>                 stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Round temperatures to group them appropriately</span></span>
<span><span class="co">#Use sequential rounding</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Tleaf</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Tleaf</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Look at unique values to detect rounding issues</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 17 18 20 22 23 25 28 27 30 33 32 35 37 38 40</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Some still did not round correctly,</span></span>
<span><span class="co">#manually correct</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">18</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">17</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">23</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">22</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">28</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">27</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">33</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">32</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">38</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">37</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Make sure it is a character string for grouping</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">T2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Create grouping variable by ID and measurement temperature</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">data</span>, col <span class="op">=</span> <span class="st">"ID2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"T2"</span><span class="op">)</span>,</span>
<span>                 sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Split by temperature group</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">data</span><span class="op">$</span><span class="va">ID2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Obtain mean temperature for group so temperature</span></span>
<span><span class="co">#response fitting is acceptable later, round to</span></span>
<span><span class="co">#2 decimal places</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Curve_Tleaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Tleaf</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#Convert from list back to dataframe</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Parse grouping variable by ID and measurement temperature</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">data</span>, col <span class="op">=</span> <span class="st">"ID2"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"T2"</span><span class="op">)</span>,</span>
<span>                 sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Make sure number of values matches number of measurement</span></span>
<span><span class="co">#temperatures. May vary slightly if plants had slightly</span></span>
<span><span class="co">#different leaf temperatures during the measurements</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Curve_Tleaf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 17.51 20.01 22.50 25.01 27.51 30.01 32.50 34.99 37.50 39.99 20.00 22.51</span></span>
<span><span class="co">## [13] 25.02 40.01</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create ID column to curve fit by ID and temperature</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">data</span>, col <span class="op">=</span> <span class="st">"ID2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Curve_Tleaf"</span><span class="op">)</span>,</span>
<span>                 sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Convert data temperature to K</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">T_leaf</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">Tleaf</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span></span>
<span><span class="co">#Fit many CO2 response curves</span></span>
<span><span class="va">fits2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"ID2"</span>,</span>
<span>                 varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                 C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span>
<span>                                 T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span>,</span>
<span>                                 PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                 g_mc <span class="op">=</span> <span class="st">"g_mc"</span><span class="op">)</span>,</span>
<span>                 funct <span class="op">=</span> <span class="va">fit_aci_response</span>,</span>
<span>                 alphag <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Extract ACi parameters</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits2</span>, output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Extract ACi graphs</span></span>
<span><span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits2</span>, output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Parse the ID variable</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">pars</span>, col <span class="op">=</span> <span class="st">"ID"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Curve_Tleaf"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Make sure curve leaf temperature is numeric</span></span>
<span><span class="va">pars</span><span class="op">$</span><span class="va">Curve_Tleaf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pars</span><span class="op">$</span><span class="va">Curve_Tleaf</span><span class="op">)</span></span>
<span><span class="va">pars</span><span class="op">$</span><span class="va">T_leaf</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">$</span><span class="va">Curve_Tleaf</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_t_response.html">fit_t_response</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pars</span><span class="op">[</span><span class="va">pars</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"S2"</span>,<span class="op">]</span>,</span>
<span>                      varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Par <span class="op">=</span> <span class="st">"V_cmax"</span>,</span>
<span>                                      T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span><span class="op">)</span>,</span>
<span>                      setvar <span class="op">=</span> <span class="st">"Hd"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = pars[pars$ID == "S2", ], varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Arrhenius"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Heskel"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Kruse"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Medlyn"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"MMRT"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-5.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Quadratic"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-6.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">[[</span><span class="st">"Topt"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-5-7.png" width="700"></p>
<p>#4. Fitting stomatal conductance models</p>
<p>The package currently supports three varieties of stomatal
conductance models (Ball et al. 1987; Leuning 1995; Medlyn et
al. 2011).</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in your data</span></span>
<span><span class="co">#Note that this data is coming from data supplied by the package</span></span>
<span><span class="co">#hence the complicated argument in read.csv()</span></span>
<span><span class="co">#This dataset is a CO2 by light response curve for a single sunflower</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Convert RH to a proportion</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">RH</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">RHcham</span> <span class="op">/</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co">#Fit stomatal conductance models</span></span>
<span><span class="co">#Can specify a single model, or all as below</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_gs_model.html">fit_gs_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                     varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                     C_air <span class="op">=</span> <span class="st">"Ca"</span>,</span>
<span>                                     g_sw <span class="op">=</span> <span class="st">"gsw"</span>,</span>
<span>                                     RH <span class="op">=</span> <span class="st">"RH"</span>,</span>
<span>                                     VPD <span class="op">=</span> <span class="st">"VPDleaf"</span><span class="op">)</span>,</span>
<span>                     model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BallBerry"</span>,</span>
<span>                               <span class="st">"Leuning"</span>,</span>
<span>                               <span class="st">"Medlyn_partial"</span>,</span>
<span>                               <span class="st">"Medlyn_full"</span><span class="op">)</span>,</span>
<span>                         D0 <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Look at BallBerry model summary:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = g_sw ~ gs_mod_ballberry(A_net = A_net, C_air = C_air, </span></span>
<span><span class="co">##     RH = RH), data = data)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">## -0.1516 -0.1007 -0.0557  0.1372  0.2498 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##                                                          Estimate Std. Error</span></span>
<span><span class="co">## (Intercept)                                             1.481e-01  1.471e-02</span></span>
<span><span class="co">## gs_mod_ballberry(A_net = A_net, C_air = C_air, RH = RH) 1.627e-05  2.832e-06</span></span>
<span><span class="co">##                                                         t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)                                              10.062  &lt; 2e-16 ***</span></span>
<span><span class="co">## gs_mod_ballberry(A_net = A_net, C_air = C_air, RH = RH)   5.744 1.13e-07 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.1248 on 94 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.2598, Adjusted R-squared:  0.2519 </span></span>
<span><span class="co">## F-statistic: 32.99 on 1 and 94 DF,  p-value: 1.132e-07</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Look at BallBerry parameters</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Parameters"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##          g0          g1</span></span>
<span><span class="co">## 1 0.1480627 1.62664e-05</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Look at BallBerry plot</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="st">"BallBerry"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Fit many g_sw models</span></span>
<span><span class="co">#Set your grouping variable</span></span>
<span><span class="co">#Here we are grouping by Qin and individual</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">Q_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Qin</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                 varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                 C_air <span class="op">=</span> <span class="st">"Ca"</span>,</span>
<span>                                 g_sw <span class="op">=</span> <span class="st">"gsw"</span>,</span>
<span>                                 RH <span class="op">=</span> <span class="st">"RH"</span>,</span>
<span>                                 VPD <span class="op">=</span> <span class="st">"VPDleaf"</span><span class="op">)</span>,</span>
<span>                 funct <span class="op">=</span> <span class="va">fit_gs_model</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"Q_2"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%Error in nlsModel(formula, mf, start, wts) : 
##   singular gradient matrix at initial parameter estimates
## 
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Look at the Medlyn_partial outputs at 750 PAR</span></span>
<span><span class="co">#Model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Formula: g_sw ~ gs_mod_opti(A_net = A_net, C_air = C_air, VPD = VPD, g0, </span></span>
<span><span class="co">##     g1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## g0  0.38778    0.03317  11.692 3.73e-07 ***</span></span>
<span><span class="co">## g1 -1.09754    0.83022  -1.322    0.216    </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.04375 on 10 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of iterations to convergence: 2 </span></span>
<span><span class="co">## Achieved convergence tolerance: 1.49e-08</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Model parameters</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Parameters"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##          g0        g1</span></span>
<span><span class="co">## 1 0.3877773 -1.097544</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Graph</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="st">"750"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Medlyn_partial"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Graph"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile parameter outputs for BallBerry model</span></span>
<span><span class="co">#Note that it's the first element for each PAR value</span></span>
<span><span class="co">#First compile list of BallBerry fits</span></span>
<span><span class="va">bbmods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#Now compile the parameters (2nd element) into a dataframe</span></span>
<span><span class="va">bbpars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbmods</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Convert group variable back to numeric</span></span>
<span><span class="va">bbpars</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">bbpars</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Take quick look at light response of intercept parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g0</span> <span class="op">~</span> <span class="va">ID</span>, <span class="va">bbpars</span><span class="op">)</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-6-3.png" width="700"></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile graphs</span></span>
<span><span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bbmods</span>,</span>
<span>                       output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                       list_element <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Look at 3rd graph</span></span>
<span><span class="va">graphs</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-6-4.png" width="700"></p>
<p>#5. Fitting light respiration</p>
<p>The package currently supports fitting light respiration according to
the slope-intercept regression extension of the Laisk method (Laisk
1977; Walker &amp; Ort 2015), the Kok method (Kok 1956), and the Yin
modification of the Kok method (Yin et al. 2009, 2011)</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in your data</span></span>
<span><span class="co">#Note that this data is coming from data supplied by the package</span></span>
<span><span class="co">#hence the complicated argument in read.csv()</span></span>
<span><span class="co">#This dataset is a CO2 by light response curve for a single sunflower</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit light respiration with Yin method</span></span>
<span><span class="va">r_light</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_r_light.html">fit_r_light_yin</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                           varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                           PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                           phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span><span class="op">)</span>,</span>
<span>                           PPFD_lower <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                           PPFD_upper <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit light respiration with Kok method</span></span>
<span><span class="va">r_light</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_r_light.html">fit_r_light_kok</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                           varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                           PPFD <span class="op">=</span> <span class="st">"Qin"</span><span class="op">)</span>,</span>
<span>                           PPFD_lower <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                           PPFD_upper <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Set your grouping variable</span></span>
<span><span class="co">#Here we are grouping by CO2_s and individual</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span> <span class="op">&lt;-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">CO2_s</span>, digits <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#For this example we need to round sequentially due to CO2_s setpoints</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">C_s</span>, digits <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit light respiration across groups with Yin method</span></span>
<span><span class="va">r_lights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                     funct <span class="op">=</span> <span class="va">fit_r_light_yin</span>,</span>
<span>                     group <span class="op">=</span> <span class="st">"C_s"</span>,</span>
<span>                     varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                           PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                           phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span><span class="op">)</span>,</span>
<span>                           PPFD_lower <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                           PPFD_upper <span class="op">=</span> <span class="fl">250</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile the outputs - note this is slightly more complex because the</span></span>
<span><span class="co">#output of the fit_many above is a list of atomic vectors, not dataframes.</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r_lights</span><span class="op">)</span></span>
<span><span class="va">r_lights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="va">r_lights</span><span class="op">)</span></span>
<span><span class="va">r_light_yin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">r_lights</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r_light_yin</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">r_light_yin</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">r_light_yin</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C_s"</span>, <span class="st">"r_light"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit the Walker-Ort method for GammaStar and light respiration</span></span>
<span><span class="va">walker_ort</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_r_light.html">fit_r_light_WalkerOrt</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                      varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                      C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span>
<span>                                      PPFD <span class="op">=</span> <span class="st">"Qin"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#View model output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = Intercept ~ Slope, data = coefs)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">## -0.36114 -0.10958 -0.05553  0.08166  0.62016 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  -0.1526     0.1176  -1.297    0.224    </span></span>
<span><span class="co">## Slope        -4.6004     0.4069 -11.307  5.1e-07 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.2513 on 10 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9275, Adjusted R-squared:  0.9202 </span></span>
<span><span class="co">## F-statistic: 127.8 on 1 and 10 DF,  p-value: 5.103e-07</span></span></code></pre>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View graph</span></span>
<span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula 'y ~ x'</span></span></code></pre>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#View coeffients</span></span>
<span><span class="va">walker_ort</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       GammaStar   r_light</span></span>
<span><span class="co">## Slope  46.00427 -0.152643</span></span></code></pre>
<p>#6. Fitting mesophyll conductance</p>
<p>Currently there is only support for fitting mesophyll conductance
according to the variable J method from Harley et al. 1992</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in your data</span></span>
<span><span class="co">#Note that this data is coming from data supplied by the package</span></span>
<span><span class="co">#hence the complicated argument in read.csv()</span></span>
<span><span class="co">#This dataset is a CO2 by light response curve for a single sunflower</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_Q_data_1.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Note: there will be issues here if the alpha value used</span></span>
<span><span class="co">#for calculating ETR is off, if GammaStar is incorrect,</span></span>
<span><span class="co">#if Rd is incorrect.</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_g_mc_variableJ.html">fit_g_mc_variableJ</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                         varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>                                         J_etr <span class="op">=</span> <span class="st">"ETR"</span>,</span>
<span>                                         C_i <span class="op">=</span> <span class="st">"Ci"</span>,</span>
<span>                                         PPFD <span class="op">=</span> <span class="st">"Qin"</span>,</span>
<span>                                         phi_PSII <span class="op">=</span> <span class="st">"PhiPS2"</span><span class="op">)</span>,</span>
<span>                                         gamma_star <span class="op">=</span> <span class="fl">46</span>,</span>
<span>                                         R_d <span class="op">=</span> <span class="fl">0.153</span>,</span>
<span>                         usealpha_Q <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         alpha_Q <span class="op">=</span> <span class="fl">0.84</span>,</span>
<span>                         beta_Q <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                         P <span class="op">=</span> <span class="fl">84</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Note that many g_mc values from this method can be unreliable</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">g_mc</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">~</span><span class="st">"("</span><span class="op">*</span><span class="va">mu</span><span class="op">*</span><span class="va">mol</span><span class="op">~</span><span class="va">mol</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">g</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">~</span><span class="st">"(mol"</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">2</span><span class="op">}</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">~</span><span class="va">Pa</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot QAQC graph according to Harley et al. 1992</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CO2_s</span>, y <span class="op">=</span> <span class="va">dCcdA</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">~</span><span class="st">"("</span><span class="op">*</span><span class="va">mu</span><span class="op">*</span><span class="va">mol</span><span class="op">~</span><span class="va">mol</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">*</span><span class="va">C</span><span class="op">[</span><span class="va">c</span><span class="op">]</span><span class="op">*</span><span class="st">"/"</span><span class="op">*</span><span class="va">delta</span><span class="op">*</span><span class="va">A</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-8-2.png" width="700"></p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dCcdA</span>, y <span class="op">=</span> <span class="va">g_mc</span>, colour <span class="op">=</span> <span class="va">reliable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">delta</span><span class="op">*</span><span class="va">C</span><span class="op">[</span><span class="va">c</span><span class="op">]</span><span class="op">*</span><span class="st">"/"</span><span class="op">*</span><span class="va">delta</span><span class="op">*</span><span class="va">A</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">g</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">~</span><span class="st">"(mol"</span><span class="op">~</span><span class="va">m</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">2</span><span class="op">}</span><span class="op">~</span><span class="va">s</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">~</span><span class="va">Pa</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span><span class="op">*</span><span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-8-3.png" width="700"></p>
<p>#7. Fitting pressure-volume curves</p>
<p>This package follows the Prometheus wiki spreadsheet from Sack and
Pasquet-Kok at:</p>
<p><a href="https://prometheusprotocols.net/function/water-relations/pressure-volume-curves/leaf-pressure-volume-curve-parameters/" class="external-link uri">https://prometheusprotocols.net/function/water-relations/pressure-volume-curves/leaf-pressure-volume-curve-parameters/</a></p>
<p>For references, see Koide et al. 2000, Sack et al. 2003, and Tyree
&amp; Hammel 1972.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"PV_curve.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit one PV curve</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_PV_curve.html">fit_PV_curve</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"L2"</span>, <span class="op">]</span>,</span>
<span>                    varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="st">"psi"</span>, </span>
<span>                                    mass <span class="op">=</span> <span class="st">"mass"</span>, </span>
<span>                                    leaf_mass <span class="op">=</span> <span class="st">"leaf_mass"</span>, </span>
<span>                                    bag_mass <span class="op">=</span> <span class="st">"bag_mass"</span>, </span>
<span>                                    leaf_area <span class="op">=</span> <span class="st">"leaf_area"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#See fitted parameters</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        SWC      PI_o psi_TLP  RWC_TLP      eps       C_FT      C_TLP  C_FTStar</span></span>
<span><span class="co">## 1 2.438935 -1.399302   -1.75 88.67684 12.20175 0.06456207 0.09923338 0.5161476</span></span></code></pre>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot water mass graph</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Plot PV Curve</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Fit all PV curves in a file</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                 funct <span class="op">=</span> <span class="va">fit_PV_curve</span>,</span>
<span>                 varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="st">"psi"</span>, </span>
<span>                                    mass <span class="op">=</span> <span class="st">"mass"</span>, </span>
<span>                                    leaf_mass <span class="op">=</span> <span class="st">"leaf_mass"</span>, </span>
<span>                                    bag_mass <span class="op">=</span> <span class="st">"bag_mass"</span>, </span>
<span>                                    leaf_area <span class="op">=</span> <span class="st">"leaf_area"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#See parameters</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##        SWC      PI_o psi_TLP  RWC_TLP      eps       C_FT      C_TLP  C_FTStar</span></span>
<span><span class="co">## 1 2.438935 -1.399302   -1.75 88.67684 12.20175 0.06456207 0.09923338 0.5161476</span></span></code></pre>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#See water mass - water potential graph</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-9-3.png" width="700"></p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#See PV curve</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-9-4.png" width="700"></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile parameter outputs</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compile the water mass - water potential graphs</span></span>
<span><span class="va">graphs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compile the PV graphs</span></span>
<span><span class="va">graphs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>#8. Fitting hydraulic vulnerability curves</p>
<p>Current approach fits a sigmoidal model and calculates hydraulic
parameters from the curve fit. See Pammenter &amp; Van der Willigen,
1998 and Ogle et al. 2009.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Read in data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"hydraulic_vulnerability.csv"</span>, </span>
<span>                             package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Fit hydraulic vulnerability curve</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_hydra_vuln_curve.html">fit_hydra_vuln_curve</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">Tree</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="va">data</span><span class="op">$</span><span class="va">Plot</span> <span class="op">==</span> <span class="st">"Irrigation"</span>,<span class="op">]</span>,</span>
<span>                            varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="st">"P"</span>,</span>
<span>                                            PLC <span class="op">=</span> <span class="st">"PLC"</span><span class="op">)</span>,</span>
<span>                            start_weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">2</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                            title <span class="op">=</span> <span class="st">"Irrigation 5"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Return Sigmoidal model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = H_log ~ psi, data = data[data$H_log &lt; Inf, ])</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       14       15       16       17       18 </span></span>
<span><span class="co">##  0.40236 -0.63441  0.01791  0.09292  0.12121 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">## (Intercept)   5.1700     0.5344   9.675  0.00234 **</span></span>
<span><span class="co">## psi          -1.0884     0.1212  -8.982  0.00291 **</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.4427 on 3 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9642, Adjusted R-squared:  0.9522 </span></span>
<span><span class="co">## F-statistic: 80.68 on 1 and 3 DF,  p-value: 0.002912</span></span></code></pre>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return Weibull model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#expecting a = 4.99, b = 3.22</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Formula: K.Kmax ~ exp(-((psi/a)^b))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parameters:</span></span>
<span><span class="co">##   Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## a   5.3160     0.0902   58.93 4.96e-07 ***</span></span>
<span><span class="co">## b   2.7778     0.2393   11.61 0.000315 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.02867 on 4 degrees of freedom</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of iterations to convergence: 8 </span></span>
<span><span class="co">## Achieved convergence tolerance: 1.49e-08</span></span></code></pre>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return model parameters with 95% confidence intervals</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">##           Value Parameter     Curve</span></span>
<span><span class="co">## b...1  4.749922         b Sigmoidal</span></span>
<span><span class="co">## a...2 -1.088445         a Sigmoidal</span></span>
<span><span class="co">## b...3  2.777799         b   Weibull</span></span>
<span><span class="co">## a...4  5.315979         a   Weibull</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return hydraulic parameters</span></span>
<span><span class="va">fit</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">##        P25      P50      P88      P95      S50       Pe     Pmax      DSI</span></span>
<span><span class="co">## 1 3.740581 4.749922 6.580451 7.455102 27.21113 2.912439 6.587406 3.674967</span></span>
<span><span class="co">## 2 3.394637 4.658873 6.967591 7.890836 20.66405 2.239211 7.078534 4.839322</span></span>
<span><span class="co">##       Curve</span></span>
<span><span class="co">## 1 Sigmoidal</span></span>
<span><span class="co">## 2   Weibull</span></span></code></pre>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return graph</span></span>
<span><span class="co">#fit[[5]] </span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span><span class="va">data</span>, col <span class="op">=</span> <span class="st">"ID"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Plot"</span>, <span class="st">"Tree"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="co">#fit many function check to make sure it works for weibull</span></span>
<span><span class="co">#Fit many curves</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>psi <span class="op">=</span> <span class="st">"P"</span>,</span>
<span>                                            PLC <span class="op">=</span> <span class="st">"PLC"</span><span class="op">)</span>,</span>
<span>                 group <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>                 start_weibull <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">4</span>, b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  <span class="co">#group = "Tree",</span></span>
<span>                  funct <span class="op">=</span> <span class="va">fit_hydra_vuln_curve</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#To select individuals from the many fits</span></span>
<span><span class="co">#Return model summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#Returns model summary</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = H_log ~ psi, data = data[data$H_log &lt; Inf, ])</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##       44       45       46       47       48 </span></span>
<span><span class="co">## -0.15427  0.06136  0.23623  0.20568 -0.34900 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  5.72729    0.34666   16.52 0.000483 ***</span></span>
<span><span class="co">## psi         -1.41591    0.07861  -18.01 0.000373 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 0.2872 on 3 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.9908, Adjusted R-squared:  0.9878 </span></span>
<span><span class="co">## F-statistic: 324.4 on 1 and 3 DF,  p-value: 0.0003733</span></span></code></pre>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return sigmoidal model output</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">##           Value Parameter     Curve</span></span>
<span><span class="co">## b...1  4.044964         b Sigmoidal</span></span>
<span><span class="co">## a...2 -1.415905         a Sigmoidal</span></span>
<span><span class="co">## b...3  3.905565         b   Weibull</span></span>
<span><span class="co">## a...4  4.580836         a   Weibull</span></span></code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return hydraulic parameters</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<pre><code><span><span class="co">##        P25      P50      P88      P95      S50       Pe     Pmax      DSI</span></span>
<span><span class="co">## 1 3.269056 4.044964 5.452141 6.124509 35.39764 2.632440 5.457488 2.825047</span></span>
<span><span class="co">## 2 3.329677 4.170508 5.552841 6.066678 32.45566 2.629945 5.711071 3.081127</span></span>
<span><span class="co">##       Curve</span></span>
<span><span class="co">## 1 Sigmoidal</span></span>
<span><span class="co">## 2   Weibull</span></span></code></pre>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Return graph</span></span>
<span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> </span></code></pre></div>
<p><img src="photosynthesis-curve-fitting-sensitivity-analyses_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Compile parameter outputs</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"dataframe"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compile graphs</span></span>
<span><span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">fits</span>,</span>
<span>                     output_type <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>                     list_element <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>#9. Sensitivity analyses</p>
<p>This segment outlines a set of functions that can be used to assess
the sensitivity of data outputs to assumed parameters. For example,
assuming different values of GammaStar, mesophyll conductance, and light
absorbance on fitted gas exchange parameters.</p>
<p>Uncomment the chunk below to run - it takes awhile. #```{r} #Read in
your data #Note that this data is coming from data supplied by the
package #hence the complicated argument in read.csv() #This dataset is a
CO2 by light response curve for a single sunflower data &lt;-
read.csv(system.file(“extdata”, “A_Ci_Q_data_1.csv”, package =
“photosynthesis”))</p>
<p>#Define a grouping factor based on light intensity to split the ACi
#curves data<span class="math inline">\(Q_2 &lt;-
as.factor((round(data\)</span>Qin, digits = 0)))</p>
<p>#Convert data temperature to K data<span class="math inline">\(T_leaf
&lt;- data\)</span>Tleaf + 273.15</p>
<p>#Run a sensitivity analysis on GammaStar and mesophyll conductance
#at 25 Celsius for one individual curve pars &lt;-
analyze_sensitivity(data = data[data$Q_2 == 1500, ], funct =
fit_aci_response, varnames = list(A_net = “A”, T_leaf = “T_leaf”, C_i =
“Ci”, PPFD = “Qin”), useg_mct = TRUE, test1 = “gamma_star25”,
element_out = 1, test2 = “g_mc25”, fitTPU = TRUE, Ea_gamma_star = 0,
Ea_g_mc = 0, values1 = seq(from = 20, to = 60, by = 4), values2 =
seq(from = 0.2, to = 2, by = 0.1))</p>
<p>#Compute measures of sensitivity par2 &lt;- compute_sensitivity(data
= pars, varnames = list(Par = “V_cmax”, test1 = “gamma_star25”, test2 =
“g_mc25”), test1_ref = 40, test2_ref = 1) #Plot sensitivity ggplot(par2,
aes(y = CE_gamma_star25, x = CE_g_mc25, colour = V_cmax))+ labs(x =
expression(g_mc[25]~“Control Coefficient”), y =
expression(Gamma[25]~“Control Coefficient”)) + geom_point() +
theme_bw()</p>
<p>ggplot(par2, aes(y = CE_gamma_star25, x = V_cmax, colour =
gamma_star25))+ geom_point() + theme_bw() #Note that in this case a
missing point appears due to an infinity #Can also plot sensitivity
measures in 2 dimensions ggplot(par2, aes(x = gamma_star25, y = g_mc25,
z = CE_gamma_star25))+ geom_tile(aes(fill = CE_gamma_star25)) + labs(x =
expression(Gamma<em>“<em>”[25]<sub>”(”<em>mu</em>mol</sub>mol^{-1}</em>”)“),
y =
expression(g[m][25]<sub>“(”<em>mu</em>mol</sub>m<sup>{-2}~s</sup>{-1}~Pa^{-1}</em>”)“))+
scale_fill_distiller(palette =”Greys”) + geom_contour(colour = “Black”,
size = 1) + theme_bw()</p>
<p>plot(PE_gamma_star25 ~ gamma_star25, par2) #```</p>
<p>#10. Dependency checking</p>
<p>A function can be used to generate an html file that assesses the
dependencies within and between packages</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#check_dependencies()</span></span></code></pre></div>
<p>#References</p>
<p>Arrhenius S. 1915. Quantitative laws in biological chemistry.
Bell.</p>
<p>Ball JT, Woodrow IE, Berry JA. 1987. A model predicting stomatal
conductance and its contribution to the control of photosynthesis under
different environmental conditions, in Progress in Photosynthesis
Research, Proceedings of the VII International Congress on
Photosynthesis, vol. 4, edited by I. Biggins, pp.  221–224, Martinus
Nijhoff, Dordrecht, Netherlands.</p>
<p>Duursma R. 2015. Plantecophys - an R package for analysing and
modeling leaf gas exchange data. PLoS ONE 10:e0143346</p>
<p>Erhardt EB. 2019. RLicor: Read Licor files. R package version
0.0.01.</p>
<p>Gu L, Pallardy SG, Tu K, Law BE, Wullschleger SD. 2010. Reliable
estimation of biochemical parameters from C3 leaf photosynthesis-
intercellular carbon dioxide response curves. Plant Cell Environ
33:1582-1874.</p>
<p>Harley PC, Loreto F, Di Marco G, Sharkey TD. 1992. Theoretical
considerations when estimating mesophyll conductance to CO2 flux by
analysis of the response of photosynthesis to CO2. Plant Physiol 98:1429
- 1436.</p>
<p>Heskel MA, O’Sullivan OS, Reich PB, Tjoelker MG, Weerasinghe LK,
Penillard A, Egerton JJG, Creek D, Bloomfield KJ, Xiang J, Sinca F,
Stangl ZR, la Torre AM, Griffin KL, Huntingford C, Hurry V, Meir P,
Turnbull MH, Atkin OK. 2016. Convergence in the temperature response of
leaf respiration across biomes and plant functional types. PNAS
113:3832-3837</p>
<p>Hobbs JK, Jiao W, Easter AD, Parker EJ, Schipper LA, Arcus VL. 2013.
Change in heat capacity for enzyme catalysis determines temperature
dependence of enzyme catalyzed rates. ACS Chemical Biology
8:2388-2393.</p>
<p>Koide RT, Robichaux RH, Morse SR, Smith CM. 2000. Plant water status,
hydraulic resistance and capacitance. In: Plant Physiological Ecology:
Field Methods and Instrumentation (eds RW Pearcy, JR Ehleringer, HA
Mooney, PW Rundel), pp. 161-183. Kluwer, Dordrecht, the Netherlands</p>
<p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234–244</p>
<p>Kruse J, Adams MA. 2008. Three parameters comprehensively describe
the temperature response of respiratory oxygen reduction. Plant Cell
Environ 31:954-967</p>
<p>Laisk A. 1977. Kinetics of photosynthesis and photorespiration in C3
plants. Nauka, Moscow.</p>
<p>Leuning R. 1995. A critical appraisal of a coupled stomatal-
photosynthesis model for C3 plants. Plant Cell Environ 18:339-357</p>
<p>Liang LL, Arcus VL, Heskel MA, O’Sullivan OS, Weerasinghe LK, Creek
D, Egerton JJG, Tjoelker MG, Atkin OK, Schipper LA. 2018. Macromolecular
rate theory (MMRT) provides a thermodynamics rationale to underpin the
convergent temperature response in plant leaf respiration. Glob Chang
Biol 24:1538-1547</p>
<p>Marshall B, Biscoe P. 1980. A model for C3 leaves describing the
dependence of net photosynthesis on irradiance. J Ex Bot 31:29-39</p>
<p>Medlyn BE, Dreyer E, Ellsworth D, Forstreuter M, Harley PC,
Kirschbaum MUF, Le Roux X, Montpied P, Strassemeyer J, Walcroft A, Wang
K, Loutstau D. 2002. Temperature response of parameters of a
biochemically based model of photosynthesis. II. A review of
experimental data. Plant Cell Environ 25:1167-1179</p>
<p>Medlyn BE, Duursma RA, Eamus D, Ellsworth DS, Prentice IC, Barton
CVM, Crous KY, Angelis PD, Freeman M, Wingate L. 2011. Reconciling the
optimal and empirical approaches to modeling stomatal conductance. Glob
Chang Biol 17:2134-2144</p>
<p>Ogle K, Barber JJ, Willson C, Thompson B. 2009. Hierarchical
statistical modeling of xylem vulnerability to cavitation. New
Phytologist 182:541-554</p>
<p>Pammenter NW, Van der Willigen CV. 1998. A mathematical and
statistical analysis of the curves illustrating vulnerability of xylem
to cavitation. Tree Physiology 18:589-593</p>
<p>Sack L, Cowan PD, Jaikumar N, Holbrook NM. 2003. The ‘hydrology’ of
leaves: co-ordination of structure and function in temperate woody
species. Plant, Cell and Environment, 26, 1343-1356</p>
<p>Sharkey TD. 2019. Is triose phosphate utilization important for
understanding photosynthesis? Journal of Experimental Botany 70,
5521-5525</p>
<p>Tyree MT, Hammel HT. 1972. Measurement of turgor pressure and water
relations of plants by pressure bomb technique. Journal of Experimental
Botany, 23, 267</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated approach
applied to leaves in a wheat (Triticum aestivum) canopy. Plant Cell
Environ 32:448-464</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements. Journal
of Experimental Botany 62: 3489–3499</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
