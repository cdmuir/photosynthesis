<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modeling C3 Photosynthesis: recommendations for common scenarios • photosynthesis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modeling C3 Photosynthesis: recommendations for common scenarios">
<meta property="og:description" content="photosynthesis">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/co2-response.html">Fitting CO2 response curves</a>
    </li>
    <li>
      <a href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a>
    </li>
    <li>
      <a href="../articles/light-respiration.html">Fitting light respiration</a>
    </li>
    <li>
      <a href="../articles/light-response.html">Fitting light response curves</a>
    </li>
    <li>
      <a href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a>
    </li>
    <li>
      <a href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
    <li>
      <a href="../articles/pressure-volume.html">Fitting pressure-volume curves</a>
    </li>
    <li>
      <a href="../articles/sensitivity-analysis.html">Sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a>
    </li>
    <li>
      <a href="../articles/temperature-response.html">Fitting temperature response curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Modeling C3 Photosynthesis: recommendations for
common scenarios</h1>
                        <h4 data-toc-skip class="author">Chris Muir</h4>
            
            <h4 data-toc-skip class="date">2022-11-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/vignettes/modeling-recommendations.Rmd" class="external-link"><code>vignettes/modeling-recommendations.Rmd</code></a></small>
      <div class="hidden name"><code>modeling-recommendations.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: minpack.lm</span></span>
<span><span class="co">#&gt; Loading required package: units</span></span>
<span><span class="co">#&gt; udunits database from /Library/Frameworks/R.framework/Versions/4.2/Resources/library/units/share/udunits/udunits2.xml</span></span></code></pre></div>
<div class="section level2">
<h2 id="typical-hypostomatous-leaf">‘Typical’ hypostomatous leaf<a class="anchor" aria-label="anchor" href="#typical-hypostomatous-leaf"></a>
</h2>
<p>Here I show how to implement a model close to the most widely used
ones, in which boundary layer conductances are high, cuticular
conductance is 0, all stomatal conductance is through the lower
(abaxial) leaf surface, and there is a single mesophyll conductance. The
advantage of this approach are that is its simplicity. You can ignore
several complexities such as:</p>
<ul>
<li>Low boundary layer conductance that varies between surfaces (can
happen in large leaves at low wind speed)</li>
<li>Large cuticular conductance (this can be happen in young
leaves)</li>
<li>Stomatal conductance can occur through both surface in
amphistomatous leaves (this is common in herbs, for example)</li>
<li>Mesophyll conductance can be partitioned into air and liquid
phases</li>
</ul>
<p>If these complexities are important to you, consider more complex
models you can implement with <strong>photosynthesis</strong>. But, if
you don’t care, here’s how to make things simple:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="va">bake_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_bakepar</a></span><span class="op">(</span><span class="op">)</span>                       <span class="co"># temperature response parameters</span></span>
<span><span class="va">constants</span>  <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_constants</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># physical constants</span></span>
<span><span class="co"># leaf parameters</span></span>
<span><span class="va">leaf_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_leafpar</a></span><span class="op">(</span></span>
<span>  replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set cuticular conductance to 0</span></span>
<span>    g_uc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    <span class="co"># All conductance through lower stomata and mesophyll</span></span>
<span>    k_mc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    k_sc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>   </span>
<span><span class="va">enviro_par</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_enviropar</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># environmental parameters</span></span>
<span></span>
<span><span class="fu"><a href="../reference/photosynthesis.html">photo</a></span><span class="op">(</span><span class="va">leaf_par</span>, <span class="va">enviro_par</span>, <span class="va">bake_par</span>, <span class="va">constants</span>, use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">g_sc</span>, <span class="va">A</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Stomatal conductance to CO2 (g_sc) and net photosynthetic carbon assimilation (A) from C3 photosynthesis model."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Stomatal conductance to CO2 (g_sc) and net photosynthetic
carbon assimilation (A) from C3 photosynthesis model.</caption>
<thead><tr class="header">
<th align="right">g_sc</th>
<th align="right">A</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.4 [mol/m^2/s]</td>
<td align="right">26.37885 [umol/m^2/s]</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="amphistomatous-leaf">Amphistomatous leaf<a class="anchor" aria-label="anchor" href="#amphistomatous-leaf"></a>
</h2>
<p>Most leaves, especially on woody plants, are hypostomatous (Muir
2015) meaning that all the stomatal conductance is through the lower
(abaxial surface). But many fast-growing herbaceous species, especially
crops (Milla <em>et al.</em> 2013), are amphistomatous. There are not a
lot of measurements of how much conductance occurs through each surface
(but see Wall <em>et al.</em> 2022), but we assume that if stomata are
present on both leaf surfaces there is CO<sub>2</sub> flux through each
surface. For amphistomatous leaves, I suggest explicitly modeling
conductance through the internal airspace (<span class="math inline">\(g_\mathrm{ias,c}\)</span>) and liquid phase (<span class="math inline">\(g_\mathrm{liq,c}\)</span>). As of version 2.1.0
this is possible in <strong>photosynthesis</strong>. Here’s a simple
example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="va">bake_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_bakepar</a></span><span class="op">(</span><span class="op">)</span>                       <span class="co"># temperature response parameters</span></span>
<span><span class="va">constants</span>  <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_constants</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># physical constants</span></span>
<span><span class="co"># leaf parameters</span></span>
<span><span class="va">leaf_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_leafpar</a></span><span class="op">(</span></span>
<span>  replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set cuticular conductance to 0</span></span>
<span>    g_uc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    <span class="co"># Half of conductance through each surface</span></span>
<span>    k_mc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># airspace conductance: define effective distance through airspace</span></span>
<span>    <span class="co"># See Nobel (2020) pg. 431</span></span>
<span>    delta_ias_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">um</span><span class="op">)</span>,</span>
<span>    delta_ias_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">um</span><span class="op">)</span>,</span>
<span>    <span class="co"># liquid conductance: sum of cell wall, plasma membrane, and cytosol resistance</span></span>
<span>    <span class="co"># We are implicitly ignoring chloroplast resistance</span></span>
<span>    <span class="co"># See Nobel (2020) pg. 448-452</span></span>
<span>    A_mes_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    g_liqc25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    k_sc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/units/man/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>   </span>
<span><span class="va">enviro_par</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_enviropar</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># environmental parameters</span></span>
<span></span>
<span><span class="fu"><a href="../reference/photosynthesis.html">photo</a></span><span class="op">(</span><span class="va">leaf_par</span>, <span class="va">enviro_par</span>, <span class="va">bake_par</span>, <span class="va">constants</span>, use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">g_sc</span>, <span class="va">g_iasc_lower</span>, <span class="va">g_iasc_upper</span>, <span class="va">g_liqc</span>, <span class="va">A</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Stomatal conductance to CO2 (g_sc), internal airspace resistance through lower and upper surfaces (g_iasc_x), liquid-phase conductance (g_liqc), and net photosynthetic carbon assimilation (A) from C3 photosynthesis model."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Stomatal conductance to CO2 (g_sc), internal airspace
resistance through lower and upper surfaces (g_iasc_x), liquid-phase
conductance (g_liqc), and net photosynthetic carbon assimilation (A)
from C3 photosynthesis model.</caption>
<colgroup>
<col width="16%">
<col width="21%">
<col width="21%">
<col width="17%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="right">g_sc</th>
<th align="right">g_iasc_lower</th>
<th align="right">g_iasc_upper</th>
<th align="right">g_liqc</th>
<th align="right">A</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.4 [mol/m^2/s]</td>
<td align="right">6.146029 [mol/m^2/s]</td>
<td align="right">6.146029 [mol/m^2/s]</td>
<td align="right">0.02 [mol/m^2/s]</td>
<td align="right">27.4933 [umol/m^2/s]</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Muir CD. 2015. Making pore choices: repeated regime shifts in
stomatal ratio. <em>Proc Roy Soc B</em> 282: 20151498.</p>
<p>Nobel PS. 2020. <em>Physicochemical and Environmental Plant
Physiology</em>. 5th Edition. Academic Press.</p>
<p>Rubén M, N de Diego-Vico, N Martín-Robles. 2013. Shifts in stomatal
traits following the domestication of plant species. <em>Journal of
Experimental Botany</em> 64(11): 3137–3146.</p>
<p>Wall S, S Vialet-Chabrand, P Davey, JV Rie, A Galle, J Cockram, T
Lawson. 2022. Stomata on the abaxial and adaxial leaf surfaces
contribute differently to leaf gas exchange and photosynthesis in wheat.
<em>New Phytologist</em> 235(5): 1743-1756.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
