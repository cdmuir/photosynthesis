<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Modeling C3 Photosynthesis: recommendations for common scenarios • photosynthesis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modeling C3 Photosynthesis: recommendations for common scenarios">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photosynthesis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/co2-response.html">Fitting CO2 response curves</a></li>
    <li><a class="dropdown-item" href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a></li>
    <li><a class="dropdown-item" href="../articles/light-respiration.html">Fit models to estimate light respiration</a></li>
    <li><a class="dropdown-item" href="../articles/light-response.html">Fitting light response curves</a></li>
    <li><a class="dropdown-item" href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a></li>
    <li><a class="dropdown-item" href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a></li>
    <li><a class="dropdown-item" href="../articles/pressure-volume.html">Fitting pressure-volume curves</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a></li>
    <li><a class="dropdown-item" href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-response.html">Fitting temperature response curves</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/cdmuir/photosynthesis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modeling C3 Photosynthesis: recommendations for common scenarios</h1>
                        <h4 data-toc-skip class="author">Chris Muir</h4>
            
            <h4 data-toc-skip class="date">2024-11-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/vignettes/modeling-recommendations.Rmd"><code>vignettes/modeling-recommendations.Rmd</code></a></small>
      <div class="d-none name"><code>modeling-recommendations.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: minpack.lm</span></span>
<span><span class="co">#&gt; Loading required package: units</span></span>
<span><span class="co">#&gt; udunits database from /Library/Frameworks/R.framework/Versions/4.4-x86_64/Resources/library/units/share/udunits/udunits2.xml</span></span></code></pre></div>
<div class="section level2">
<h2 id="typical-hypostomatous-leaf">‘Typical’ hypostomatous leaf<a class="anchor" aria-label="anchor" href="#typical-hypostomatous-leaf"></a>
</h2>
<p>Here I show how to implement a model close to the most widely used
ones, in which boundary layer conductances are high, cuticular
conductance is 0, all stomatal conductance is through the lower
(abaxial) leaf surface, and there is a single mesophyll conductance. The
advantage of this approach are that is its simplicity. You can ignore
several complexities such as:</p>
<ul>
<li>Low boundary layer conductance that varies between surfaces (can
happen in large leaves at low wind speed)</li>
<li>Large cuticular conductance (this can be happen in young
leaves)</li>
<li>Stomatal conductance can occur through both surface in
amphistomatous leaves (this is common in herbs, for example)</li>
<li>Mesophyll conductance can be partitioned into air and liquid
phases</li>
</ul>
<p>If these complexities are important to you, consider more complex
models you can implement with <strong>photosynthesis</strong>. But, if
you don’t care, here’s how to make things simple:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="va">bake_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_bakepar</a></span><span class="op">(</span><span class="op">)</span>                       <span class="co"># temperature response parameters</span></span>
<span><span class="va">constants</span>  <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_constants</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># physical constants</span></span>
<span><span class="co"># leaf parameters</span></span>
<span><span class="va">leaf_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_leafpar</a></span><span class="op">(</span></span>
<span>  replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set cuticular conductance to 0</span></span>
<span>    g_uc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    <span class="co"># All conductance through lower stomata and mesophyll</span></span>
<span>    k_mc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    k_sc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>   </span>
<span><span class="va">enviro_par</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_enviropar</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># environmental parameters</span></span>
<span></span>
<span><span class="fu"><a href="../reference/photosynthesis.html">photo</a></span><span class="op">(</span><span class="va">leaf_par</span>, <span class="va">enviro_par</span>, <span class="va">bake_par</span>, <span class="va">constants</span>, use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">g_sc</span>, <span class="va">A</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Stomatal conductance to CO2 (g_sc) and net photosynthetic carbon assimilation (A) from C3 photosynthesis model."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Stomatal conductance to CO2 (g_sc) and net photosynthetic
carbon assimilation (A) from C3 photosynthesis model.</caption>
<thead><tr class="header">
<th align="right">g_sc</th>
<th align="right">A</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.4 [mol/m^2/s]</td>
<td align="right">26.37885 [umol/m^2/s]</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="amphistomatous-leaf">Amphistomatous leaf<a class="anchor" aria-label="anchor" href="#amphistomatous-leaf"></a>
</h2>
<p>Most leaves, especially on woody plants, are hypostomatous (Muir
2015) meaning that all the stomatal conductance is through the lower
(abaxial surface). But many fast-growing herbaceous species, especially
crops (Milla <em>et al.</em> 2013), are amphistomatous. There are not a
lot of measurements of how much conductance occurs through each surface
(but see Wall <em>et al.</em> 2022), but we assume that if stomata are
present on both leaf surfaces there is CO<sub>2</sub> flux through each
surface. For amphistomatous leaves, I suggest explicitly modeling
conductance through the internal airspace
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">s</mi><mo mathvariant="normal">,</mo><mi mathvariant="normal">c</mi></mrow></msub><annotation encoding="application/x-tex">g_\mathrm{ias,c}</annotation></semantics></math>)
and liquid phase
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">q</mi><mo mathvariant="normal">,</mo><mi mathvariant="normal">c</mi></mrow></msub><annotation encoding="application/x-tex">g_\mathrm{liq,c}</annotation></semantics></math>).
As of version 2.1.0 this is possible in <strong>photosynthesis</strong>.
Here’s a simple example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="va">bake_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_bakepar</a></span><span class="op">(</span><span class="op">)</span>                       <span class="co"># temperature response parameters</span></span>
<span><span class="va">constants</span>  <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_constants</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># physical constants</span></span>
<span><span class="co"># leaf parameters</span></span>
<span><span class="va">leaf_par</span>   <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_leafpar</a></span><span class="op">(</span></span>
<span>  replace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set cuticular conductance to 0</span></span>
<span>    g_uc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    <span class="co"># Half of conductance through each surface</span></span>
<span>    k_mc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="co"># airspace conductance: define effective distance through airspace</span></span>
<span>    <span class="co"># See Nobel (2020) pg. 431</span></span>
<span>    delta_ias_lower <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">um</span><span class="op">)</span>,</span>
<span>    delta_ias_upper <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">um</span><span class="op">)</span>,</span>
<span>    <span class="co"># liquid conductance: sum of cell wall, plasma membrane, and cytosol resistance</span></span>
<span>    <span class="co"># We are implicitly ignoring chloroplast resistance</span></span>
<span>    <span class="co"># See Nobel (2020) pg. 448-452</span></span>
<span>    A_mes_A <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    g_liqc25 <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="va">mol</span> <span class="op">/</span> <span class="va">m</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">s</span><span class="op">)</span>,</span>
<span>    k_sc <span class="op">=</span> <span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span>   </span>
<span><span class="va">enviro_par</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_parameters.html">make_enviropar</a></span><span class="op">(</span>use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># environmental parameters</span></span>
<span></span>
<span><span class="fu"><a href="../reference/photosynthesis.html">photo</a></span><span class="op">(</span><span class="va">leaf_par</span>, <span class="va">enviro_par</span>, <span class="va">bake_par</span>, <span class="va">constants</span>, use_tealeaves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">g_sc</span>, <span class="va">g_iasc_lower</span>, <span class="va">g_iasc_upper</span>, <span class="va">g_liqc</span>, <span class="va">A</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Stomatal conductance to CO2 (g_sc), internal airspace resistance through lower and upper surfaces (g_iasc_x), liquid-phase conductance (g_liqc), and net photosynthetic carbon assimilation (A) from C3 photosynthesis model."</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Stomatal conductance to CO2 (g_sc), internal airspace
resistance through lower and upper surfaces (g_iasc_x), liquid-phase
conductance (g_liqc), and net photosynthetic carbon assimilation (A)
from C3 photosynthesis model.</caption>
<colgroup>
<col width="16%">
<col width="21%">
<col width="21%">
<col width="17%">
<col width="21%">
</colgroup>
<thead><tr class="header">
<th align="right">g_sc</th>
<th align="right">g_iasc_lower</th>
<th align="right">g_iasc_upper</th>
<th align="right">g_liqc</th>
<th align="right">A</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.4 [mol/m^2/s]</td>
<td align="right">6.146029 [mol/m^2/s]</td>
<td align="right">6.146029 [mol/m^2/s]</td>
<td align="right">0.02 [mol/m^2/s]</td>
<td align="right">27.4933 [umol/m^2/s]</td>
</tr></tbody>
</table>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Muir CD. 2015. Making pore choices: repeated regime shifts in
stomatal ratio. <em>Proc Roy Soc B</em> 282: 20151498.</p>
<p>Nobel PS. 2020. <em>Physicochemical and Environmental Plant
Physiology</em>. 5th Edition. Academic Press.</p>
<p>Rubén M, N de Diego-Vico, N Martín-Robles. 2013. Shifts in stomatal
traits following the domestication of plant species. <em>Journal of
Experimental Botany</em> 64(11): 3137–3146.</p>
<p>Wall S, S Vialet-Chabrand, P Davey, JV Rie, A Galle, J Cockram, T
Lawson. 2022. Stomata on the abaxial and adaxial leaf surfaces
contribute differently to leaf gas exchange and photosynthesis in wheat.
<em>New Phytologist</em> 235(5): 1743-1756.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
