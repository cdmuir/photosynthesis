<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitting temperature response curves â€¢ photosynthesis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fitting temperature response curves">
<meta property="og:description" content="photosynthesis">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">photosynthesis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/co2-response.html">Fitting CO2 response curves</a>
    </li>
    <li>
      <a href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a>
    </li>
    <li>
      <a href="../articles/light-respiration.html">Fitting light respiration</a>
    </li>
    <li>
      <a href="../articles/light-response.html">Fitting light response curves</a>
    </li>
    <li>
      <a href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a>
    </li>
    <li>
      <a href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a>
    </li>
    <li>
      <a href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a>
    </li>
    <li>
      <a href="../articles/pressure-volume.html">Fitting pressure-volume curves</a>
    </li>
    <li>
      <a href="../articles/sensitivity-analysis.html">Sensitivity analysis</a>
    </li>
    <li>
      <a href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a>
    </li>
    <li>
      <a href="../articles/temperature-response.html">Fitting temperature response curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cdmuir/photosynthesis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fitting temperature response curves</h1>
                        <h4 data-toc-skip class="author">Joseph R.
Stinziano and Christopher D. Muir</h4>
            
            <h4 data-toc-skip class="date">2022-11-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/vignettes/temperature-response.Rmd" class="external-link"><code>vignettes/temperature-response.Rmd</code></a></small>
      <div class="hidden name"><code>temperature-response.Rmd</code></div>

    </div>

    
    
<p>This package provides support for multiple temperature response
functions (Arrhenius 1915; Medlyn <em>et al.</em> 2002; Kruse &amp;
Adams. 2006; Heskel <em>et al.</em> 2016; Liang <em>et al.</em>
2018).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis" class="external-link">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">round_to_nearest</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">values</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">values</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">}</span>, values <span class="op">=</span> <span class="va">values</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Read in data</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_T_data.csv"</span>, package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu">round_to_nearest</span><span class="op">(</span><span class="va">Tleaf</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">17.5</span>, <span class="fl">40</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Convert data temperature to K</span></span>
<span>    T_leaf <span class="op">=</span> <span class="va">Tleaf</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate mean temperature for group so temperature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span></span>
<span>    <span class="va">.</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Curve_Tleaf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Tleaf</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"group"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create ID column to curve fit by ID and temperature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Curve_Tleaf</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="va">A</span>, C_i <span class="op">=</span> <span class="va">Ci</span>, PPFD <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span></span>
<span>   </span>
<span><span class="co"># Fit many CO2 response curves</span></span>
<span><span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"ID2"</span>,</span>
<span>  funct <span class="op">=</span> <span class="va">fit_aci_response</span>,</span>
<span>  alphag <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Extract ACi parameters</span></span>
<span><span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>, output_type <span class="op">=</span> <span class="st">"dataframe"</span>, list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Extract ACi graphs</span></span>
<span><span class="va">graphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>, output_type <span class="op">=</span> <span class="st">"list"</span>, list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Parse the ID variable</span></span>
<span><span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">pars</span>, col <span class="op">=</span> <span class="st">"ID"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Curve_Tleaf"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Make sure curve leaf temperature is numeric and convert to K</span></span>
<span>    T_leaf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Curve_Tleaf</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="op">)</span></span>
<span>    </span>
<span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_t_response.html">fit_t_response</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pars</span>, <span class="va">ID</span> <span class="op">==</span> <span class="st">"S2"</span><span class="op">)</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Par <span class="op">=</span> <span class="st">"V_cmax"</span>, T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span><span class="op">)</span>,</span>
<span>  setvar <span class="op">=</span> <span class="st">"Hd"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span>
<span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par =</span></span>
<span><span class="co">## "V_cmax", : NAs introduced by coercion</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Graphs</span></span>
<span><span class="co"># fit[["Arrhenius"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Heskel"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Kruse"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Medlyn"]][["Graph"]]</span></span>
<span><span class="co"># fit[["MMRT"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Quadratic"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Topt"]][["Graph"]]</span></span></code></pre></div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Arrhenius S. 1915. Quantitative laws in biological chemistry.
Bell.</p>
<p>Heskel MA, Oâ€™Sullivan OS, Reich PB, Tjoelker MG, Weerasinghe LK,
Penillard A, Egerton JJG, Creek D, Bloomfield KJ, Xiang J, Sinca F,
Stangl ZR, la Torre AM, Griffin KL, Huntingford C, Hurry V, Meir P,
Turnbull MH, Atkin OK. 2016. Convergence in the temperature response of
leaf respiration across biomes and plant functional types. <em>PNAS</em>
113:3832-3837</p>
<p>Kruse J, Adams MA. 2008. Three parameters comprehensively describe
the temperature response of respiratory oxygen reduction. <em>Plant,
Cell &amp; Environment</em> 31:954-967</p>
<p>Liang LL, Arcus VL, Heskel MA, Oâ€™Sullivan OS, Weerasinghe LK, Creek
D, Egerton JJG, Tjoelker MG, Atkin OK, Schipper LA. 2018. Macromolecular
rate theory (MMRT) provides a thermodynamics rationale to underpin the
convergent temperature response in plant leaf respiration. <em>Global
Change Biology</em> 24:1538-1547</p>
<p>Medlyn BE, Dreyer E, Ellsworth D, Forstreuter M, Harley PC,
Kirschbaum MUF, Le Roux X, Montpied P, Strassemeyer J, Walcroft A, Wang
K, Loutstau D. 2002. Temperature response of parameters of a
biochemically based model of photosynthesis. II. A review of
experimental data. <em>Plant, Cell &amp; Environment</em>
25:1167-1179.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
