<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting temperature response curves â€¢ photosynthesis</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting temperature response curves">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photosynthesis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/co2-response.html">Fitting CO2 response curves</a></li>
    <li><a class="dropdown-item" href="../articles/hydraulic-vulnerability.html">Fitting hydraulic vulnerability curves</a></li>
    <li><a class="dropdown-item" href="../articles/light-respiration.html">Fit models to estimate light respiration</a></li>
    <li><a class="dropdown-item" href="../articles/light-response.html">Fitting light response curves</a></li>
    <li><a class="dropdown-item" href="../articles/mesophyll-conductance.html">Fitting mesophyll conductance</a></li>
    <li><a class="dropdown-item" href="../articles/modeling-recommendations.html">Modeling C3 Photosynthesis: recommendations for common scenarios</a></li>
    <li><a class="dropdown-item" href="../articles/photosynthesis-introduction.html">Introduction to the photosynthesis package</a></li>
    <li><a class="dropdown-item" href="../articles/pressure-volume.html">Fitting pressure-volume curves</a></li>
    <li><a class="dropdown-item" href="../articles/sensitivity-analysis.html">Sensitivity analysis</a></li>
    <li><a class="dropdown-item" href="../articles/stomatal-conductance.html">Fitting stomatal conductance models</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-response.html">Fitting temperature response curves</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/cdmuir/photosynthesis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting temperature response curves</h1>
                        <h4 data-toc-skip class="author">Joseph R.
Stinziano and Christopher D. Muir</h4>
            
            <h4 data-toc-skip class="date">2024-11-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cdmuir/photosynthesis/blob/HEAD/vignettes/temperature-response.Rmd"><code>vignettes/temperature-response.Rmd</code></a></small>
      <div class="d-none name"><code>temperature-response.Rmd</code></div>
    </div>

    
    
<p>This package provides support for multiple temperature response
functions (Arrhenius 1915; Medlyn <em>et al.</em> 2002; Kruse &amp;
Adams. 2006; Heskel <em>et al.</em> 2016; Liang <em>et al.</em>
2018).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cdmuir/photosynthesis">photosynthesis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">round_to_nearest</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">values</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">values</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">values</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">values</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">}</span>, values <span class="op">=</span> <span class="va">values</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Read in data</span></span>
<span><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"A_Ci_T_data.csv"</span>, package <span class="op">=</span> <span class="st">"photosynthesis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu">round_to_nearest</span><span class="op">(</span><span class="va">Tleaf</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">17.5</span>, <span class="fl">40</span>, by <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="co"># Convert data temperature to K</span></span>
<span>    T_leaf <span class="op">=</span> <span class="va">Tleaf</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate mean temperature for group so temperature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span></span>
<span>    <span class="va">.</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>Curve_Tleaf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Tleaf</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"group"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Create ID column to curve fit by ID and temperature</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">Curve_Tleaf</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>A_net <span class="op">=</span> <span class="va">A</span>, C_i <span class="op">=</span> <span class="va">Ci</span>, PPFD <span class="op">=</span> <span class="va">Qin</span><span class="op">)</span></span>
<span>   </span>
<span><span class="co"># Fit many CO2 response curves</span></span>
<span><span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_many.html">fit_many</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"ID2"</span>,</span>
<span>  funct <span class="op">=</span> <span class="va">fit_aci_response</span>,</span>
<span>  alphag <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `fit_many()` was deprecated in photosynthesis 2.1.3.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract ACi parameters</span></span>
<span><span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>, output_type <span class="op">=</span> <span class="st">"dataframe"</span>, list_element <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Extract ACi graphs</span></span>
<span><span class="va">graphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/compile_data.html">compile_data</a></span><span class="op">(</span><span class="va">fits</span>, output_type <span class="op">=</span> <span class="st">"list"</span>, list_element <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Parse the ID variable</span></span>
<span><span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">pars</span>, col <span class="op">=</span> <span class="st">"ID"</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Curve_Tleaf"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Make sure curve leaf temperature is numeric and convert to K</span></span>
<span>    T_leaf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Curve_Tleaf</span><span class="op">)</span> <span class="op">+</span> <span class="fl">273.15</span></span>
<span>  <span class="op">)</span></span>
<span>    </span>
<span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="../reference/fit_t_response.html">fit_t_response</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pars</span>, <span class="va">ID</span> <span class="op">==</span> <span class="st">"S2"</span><span class="op">)</span>,</span>
<span>  varnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Par <span class="op">=</span> <span class="st">"V_cmax"</span>, T_leaf <span class="op">=</span> <span class="st">"T_leaf"</span><span class="op">)</span>,</span>
<span>  setvar <span class="op">=</span> <span class="st">"Hd"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span></code></pre>
<pre><code><span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span>
<span><span class="co">## Warning in fit_t_response(data = filter(pars, ID == "S2"), varnames = list(Par</span></span>
<span><span class="co">## = "V_cmax", : NAs introduced by coercion</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Graphs</span></span>
<span><span class="co"># fit[["Arrhenius"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Heskel"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Kruse"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Medlyn"]][["Graph"]]</span></span>
<span><span class="co"># fit[["MMRT"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Quadratic"]][["Graph"]]</span></span>
<span><span class="co"># fit[["Topt"]][["Graph"]]</span></span></code></pre></div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Arrhenius S. 1915. Quantitative laws in biological chemistry.
Bell.</p>
<p>Heskel MA, Oâ€™Sullivan OS, Reich PB, Tjoelker MG, Weerasinghe LK,
Penillard A, Egerton JJG, Creek D, Bloomfield KJ, Xiang J, Sinca F,
Stangl ZR, la Torre AM, Griffin KL, Huntingford C, Hurry V, Meir P,
Turnbull MH, Atkin OK. 2016. Convergence in the temperature response of
leaf respiration across biomes and plant functional types. <em>PNAS</em>
113:3832-3837</p>
<p>Kruse J, Adams MA. 2008. Three parameters comprehensively describe
the temperature response of respiratory oxygen reduction. <em>Plant,
Cell &amp; Environment</em> 31:954-967</p>
<p>Liang LL, Arcus VL, Heskel MA, Oâ€™Sullivan OS, Weerasinghe LK, Creek
D, Egerton JJG, Tjoelker MG, Atkin OK, Schipper LA. 2018. Macromolecular
rate theory (MMRT) provides a thermodynamics rationale to underpin the
convergent temperature response in plant leaf respiration. <em>Global
Change Biology</em> 24:1538-1547</p>
<p>Medlyn BE, Dreyer E, Ellsworth D, Forstreuter M, Harley PC,
Kirschbaum MUF, Le Roux X, Montpied P, Strassemeyer J, Walcroft A, Wang
K, Loutstau D. 2002. Temperature response of parameters of a
biochemically based model of photosynthesis. II. A review of
experimental data. <em>Plant, Cell &amp; Environment</em>
25:1167-1179.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Stinziano, Cassaundra Roback, Demi Sargent, Bridget Murphy, Patrick Hudson, Chris Muir.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
